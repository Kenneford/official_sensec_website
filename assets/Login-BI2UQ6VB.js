import{e as V,a as Y,f as v,g as A,h as G,r as l,i as H,n as m,bM as J,j as t,B as c,T as S,l as Q,bL as X}from"./index-BgAz6R-J.js";/* empty css               */import{c as M}from"./muiStyling-DmAU0UFM.js";import{R as Z}from"./Redirection-ChYyGRqW.js";import{L as F}from"./LoadingProgress-C8hgd9jP.js";import{L as U,a as ee}from"./LoginOutlined-9Zhad84D.js";import{G as L}from"./Grid-LFq3_oT1.js";import{V as se,a as te}from"./VisibilityOff-DYRSYdR0.js";import{T as re}from"./TaskAlt-bfh00-md.js";import"./FormLabel-C_YAtYcn.js";import"./index-DcfIKM1A.js";import"./useControlled-BV50I6TR.js";import"./useThemeProps-JU6LSmm0.js";import"./getThemeProps-IXaZHU6q.js";import"./index-CUAsLGHl.js";import"./IconButton-DXnj9XZJ.js";function ve(){var R,E,O,z;const f=V(),d=Y(),i=localStorage.getItem("loginAction"),{loginStatus:p,successMessage:h,error:x}=v(r=>r==null?void 0:r.authUser),e=v(A),j=v(G),[I,y]=l.useState(null),[D,W]=l.useState(!1),[q,_]=l.useState(!1),[b,P]=l.useState(!1),[g,w]=l.useState(!1),B=r=>{r.preventDefault(),_(n=>!n)},[s,K]=l.useState({uniqueId:"",userName:"",password:""});console.log(s);const o=j==null?void 0:j.find(r=>(r==null?void 0:r.uniqueId)===(s==null?void 0:s.uniqueId)),T=r=>{K({...s,[r.target.name]:r.target.value})},N=()=>{var r,n,a,u,$;((r=s==null?void 0:s.password)==null?void 0:r.length)<6?w(!0):i!=null&&i.includes("Admins")&&!((n=o==null?void 0:o.roles)!=null&&n.includes("admin"))?m.error("You're not an admin",{position:"top-right",theme:"light",toastId:"loginRejection"}):i!=null&&i.includes("Students")&&!((a=o==null?void 0:o.roles)!=null&&a.includes("student"))?m.error("You're not a student",{position:"top-right",theme:"light",toastId:"loginRejection"}):i!=null&&i.includes("Lectures")&&!((u=o==null?void 0:o.roles)!=null&&u.includes("lecturer"))?m.error("You're not a lecturer",{position:"top-right",theme:"light",toastId:"loginRejection"}):i!=null&&i.includes("NT-Staff")&&!(($=o==null?void 0:o.roles)!=null&&$.includes("nt-Staff"))?m.error("You're not a NT-Staff",{position:"top-right",theme:"light",toastId:"loginRejection"}):(console.log("Form submitted!"),f(X({uniqueId:s==null?void 0:s.uniqueId,password:s==null?void 0:s.password})))},C=r=>{r.key==="Enter"&&(r.preventDefault(),N())};l.useEffect(()=>{var r;if(s!=null&&s.uniqueId&&!o){P(!0);return}else P(!1);g&&((s==null?void 0:s.password)===""||((r=s==null?void 0:s.password)==null?void 0:r.length)>=6)&&w(!1)},[s,o,g]),l.useEffect(()=>{f(H())},[f]);const k=(()=>{var r,n,a,u;return(r=e==null?void 0:e.roles)!=null&&r.includes("admin")?"admin/Dashboard/Overview":(n=e==null?void 0:e.roles)!=null&&n.includes("lecturer")?"lecturer/Dashboard/Overview":(a=e==null?void 0:e.roles)!=null&&a.includes("student")?"student/Dashboard/Overview":(u=e==null?void 0:e.roles)!=null&&u.includes("nt-Staff")?"nt_staff/Dashboard/Overview":"*"})();return l.useEffect(()=>{var r,n;if(p==="pending"&&y(!1),p==="rejected"){(n=(r=x==null?void 0:x.errorMessage)==null?void 0:r.message)==null||n.map(a=>{m.error(a,{position:"top-right",theme:"light",toastId:a})}),setTimeout(()=>{y(null)},3e3);return}p==="success"&&(m.success(h,{position:"top-right",theme:"dark",toastId:h}),e?(f(J()),d(`/sensec/users/${e==null?void 0:e.uniqueId}/${k}`)):setTimeout(()=>{W(!0)},3e3))},[p,x,h,d,f,o,e,k]),l.useLayoutEffect(()=>{var r,n,a,u;if((r=e==null?void 0:e.roles)!=null&&r.includes("admin"))return d(`/sensec/users/${e==null?void 0:e.uniqueId}/admin/Dashboard/Overview`);if((n=e==null?void 0:e.roles)!=null&&n.includes("lecturer"))return d(`/sensec/users/${e==null?void 0:e.uniqueId}/lecturer/Dashboard/Overview`);if((a=e==null?void 0:e.roles)!=null&&a.includes("student"))return d(`/sensec/users/${e==null?void 0:e.uniqueId}/student/Dashboard/Overview`);if((u=e==null?void 0:e.roles)!=null&&u.includes("nt_Staff"))return d(`/sensec/users/${e==null?void 0:e.uniqueId}/nt_Staff/Dashboard/Overview`)},[e,d]),t.jsx(c,{sx:{width:{xs:"95%",sm:"36rem"}},margin:"auto",mt:5,mb:5,display:"flex",justifyContent:"center",alignItems:"center",fontSize:"calc(.7rem + 1vmin)",height:"100%",children:t.jsxs(c,{component:"form",onSubmit:r=>{r.preventDefault(),N()},color:"#696969",sx:{filter:"drop-shadow(0 0 0.3em rgb(255, 255, 255, 0.68))",boxShadow:"0px 1px 9px 1px #454343ad",borderRadius:".4rem",display:{xs:"block",sm:"flex"}},p:1,width:"100%",children:[t.jsx(c,{width:"22rem",sx:{display:{xs:"none",sm:"block"}},children:t.jsxs(c,{className:"left",children:[t.jsxs("h1",{children:["Welcome, Cherished ",i==="Admins Login"&&"Admin",i==="Lecturers Login"&&"Lecturer",i==="NT-Staffs Login"&&"NT-Staff",i==="Students Login"&&"Student","."]}),t.jsx("p",{children:"The Great Sensec is glad to have you here. Kindly login to access your dashboard."})]})}),t.jsxs(c,{ml:{xs:0,sm:1},children:[t.jsxs(c,{mt:2,mb:4,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",children:[t.jsx(U,{style:{color:"#767474",fontSize:"2rem"}}),t.jsx(S,{variant:"h5",component:"h1",mb:2,sx:{fontSize:"1.7rem"},children:"Login"}),t.jsx(c,{className:"profilePictureWrap",children:t.jsx(c,{className:"profilePictureCont",children:t.jsx("img",{className:"profileImg",src:o?(E=(R=o==null?void 0:o.personalInfo)==null?void 0:R.profilePicture)==null?void 0:E.url:"/assets/noAvatar.png",alt:""})})})]}),t.jsxs(L,{container:!0,spacing:2,children:[t.jsx(L,{item:!0,xs:12,children:t.jsx(M,{fullWidth:!0,label:"Unique-ID",name:"uniqueId",value:s==null?void 0:s.uniqueId,onChange:T,required:!0,onKeyDown:C,error:b,helperText:b?"Invalid user-ID!":"",sx:{"& .MuiInputLabel-asterisk":{color:s!=null&&s.uniqueId&&!b?"green":"red"}}})}),t.jsx(L,{item:!0,xs:12,children:t.jsx(M,{fullWidth:!0,label:"Password",name:"password",value:s==null?void 0:s.password,onChange:T,required:!0,onKeyDown:C,error:g,helperText:g&&((O=s==null?void 0:s.password)==null?void 0:O.length)>0&&((z=s==null?void 0:s.password)==null?void 0:z.length)<6?"Password must be at least 6 characters long!":"",type:q?"text":"password",slotProps:{input:{endAdornment:t.jsx(c,{component:"button",onClick:B,bgcolor:"transparent",children:q?t.jsx(se,{sx:{color:"#696969"}}):t.jsx(te,{sx:{color:"#696969"}})})}},sx:{"& .MuiInputLabel-asterisk":{color:s!=null&&s.password&&!g?"green":"red"}}})})]}),t.jsx("div",{className:"forgotPassword",children:t.jsx("p",{onClick:()=>d("/sensec/forgot_password"),children:"Forgot Password"})}),t.jsx(c,{mt:1,children:t.jsxs(S,{children:["Don't have an account?"," ",t.jsx(S,{component:"span",onClick:()=>d("/sensec/sign_up"),sx:{cursor:"pointer",color:"green"},children:"Sign-up"})]})}),t.jsxs(Q,{type:"submit",variant:"contained",fullWidth:!0,sx:{backgroundColor:"green",margin:"2rem 0",padding:".5rem",letterSpacing:"1px",textTransform:"capitalize",fontSize:"1em",minHeight:"3.7rem"},children:[I===!1&&t.jsx(F,{color:"#fff",size:"1.3rem"}),I===null&&t.jsxs(t.Fragment,{children:["Login",t.jsx(ee,{className:"signupIcon",sx:{marginLeft:".5rem"}})]}),I===!0&&p==="success"&&!D&&t.jsxs(t.Fragment,{children:["Success"," ",t.jsx(re,{className:"signupIcon",sx:{marginLeft:".5rem"}})]}),D&&t.jsx(Z,{color:"#fff",size:"1.3rem"})]})]})]})})}export{ve as Login};
