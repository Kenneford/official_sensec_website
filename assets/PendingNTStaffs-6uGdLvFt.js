import{f as $,g as pe,a as ue,e as de,u as fe,r as s,n as I,i as R,cE as F,cF as O,j as t,B as u,cG as ge,cH as he,cI as je,cJ as Se}from"./index-BrKZIgIs.js";/* empty css                     */import{X as ye}from"./index.es-DkKOh-Zr.js";import{N as Te}from"./NewEmploymentModal-C_IEBMfs.js";import{c as xe}from"./usersInfoTableStyle-D7rSQ0GJ.js";import{b as Me}from"./LinksFormat-DQzWvp0Y.js";import{b as ve}from"./UsersInfoDataFormat-6-R0KIZy.js";import{a as Ne}from"./FetchNT-Staffs-E59mfj7W.js";import{S as Ee}from"./SearchFilter-h_gsYJVm.js";import{F as Ie}from"./FetchClassLevel-4JV9FIfU.js";import{G as _}from"./Grid-CMH8KWik.js";/* empty css               */import"./Stack-BeB3Qk7_.js";import"./styled-Cwx8AUm3.js";import"./useThemeProps-DJrrucl-.js";import"./getThemeProps-VIUuhX1y.js";import"./react-router-hash-link.esm-CcfNRvgg.js";import"./Edit-YA8l4Fd8.js";import"./TaskAlt-CZKWz0j9.js";import"./SchoolOutlined-D5CmX2zz.js";import"./DateFormatter-B-8qT63H.js";import"./DemotionsModal-CxSKSEQU.js";import"./index-B10MRCJG.js";import"./Close-B2v4nXUt.js";/* empty css                   */import"./Search-svh79qAU.js";function ot(){const l=$(pe),i=Ne(),w=ue(),H=Me(),n=de();Ie();const{approveEmploymentStatus:d,approveMultiEmploymentStatus:f,rejectEmploymentStatus:g,rejectMultiEmploymentStatus:h,successMessage:Re,error:o}=$(e=>e.employment),{adminCurrentAction:j,adminCurrentLink:x,class_level:Ae,employees_link:A}=fe(),[L,P]=s.useState(""),[q,G]=s.useState("");s.useState("");const[W,M]=s.useState(null),[c,X]=s.useState(""),[z,v]=s.useState(null),[J,N]=s.useState(null),[Q,D]=s.useState(!1),[Y,b]=s.useState(!1),[K,E]=s.useState(null),r=i==null?void 0:i.filter(e=>e.personalInfo.firstName.toLowerCase().includes(c)||e.personalInfo.firstName.includes(c)||e.personalInfo.lastName.toLowerCase().includes(c)||e.personalInfo.lastName.includes(c)),S=i==null?void 0:i.find(e=>(e==null?void 0:e._id)===L),y=i==null?void 0:i.find(e=>(e==null?void 0:e._id)===q),[V,Z]=s.useState(!1),[ee,U]=s.useState(!1),[te,se]=s.useState(!1),[oe,ae]=s.useState(""),[le,re]=s.useState(!1),ie=ve({setCurrentNTStaff:P,loadingComplete:W,setLoadingComplete:M,rejectLoadingComplete:z,setRejectLoadingComplete:v,authAdmin:l,foundNTStaff:S,approveEmploymentStatus:d,rejectEmploymentStatus:g,openApproveEmploymentModal:le,setOpenApproveEmploymentModal:re,setRejectNTStaff:G,nTStaffToReject:y,openRejectModal:te,setOpenRejectModal:se}),[m,B]=s.useState([]),[T,k]=s.useState(!1);console.log(m);const ne=e=>{var a;if(e){const p=(a=e==null?void 0:e.selectedRows)==null?void 0:a.map(C=>({uniqueId:C==null?void 0:C.uniqueId}));B(p)}else B([])},me=()=>{Z(!0),ae("You're being redirected"),setTimeout(()=>{w(`/sensec/users/${l==null?void 0:l.uniqueId}/admin/${j}/new_employment`)},3e3)};s.useEffect(()=>{if(S&&!y){if(d==="pending"&&M(!1),d==="rejected"){setTimeout(()=>{M(null)},3e3),setTimeout(()=>{var e,a;(a=(e=o==null?void 0:o.errorMessage)==null?void 0:e.message)==null||a.map(p=>I.error(p,{position:"top-right",theme:"dark"}))},2e3);return}d==="success"&&(setTimeout(()=>{M(!0)},3e3),setTimeout(()=>{n(R())},6e3))}},[n,d,o,S,y]),s.useEffect(()=>{if(y&&!S){if(g==="pending"&&v(!1),g==="rejected"){setTimeout(()=>{v(null)},3e3),setTimeout(()=>{var e,a;(a=(e=o==null?void 0:o.errorMessage)==null?void 0:e.message)==null||a.map(p=>I.error(p,{position:"top-right",theme:"dark"}))},2e3);return}g==="success"&&(setTimeout(()=>{v(!0)},3e3),setTimeout(()=>{n(R())},6e3))}},[n,g,o,y,S]),s.useEffect(()=>{if(m&&f==="pending"&&N(!1),m&&f==="rejected"){setTimeout(()=>{N(null),D(!1),n(F())},3e3),setTimeout(()=>{var e,a;(a=(e=o==null?void 0:o.errorMessage)==null?void 0:e.message)==null||a.map(p=>I.error(p,{position:"top-right",theme:"dark",toastId:"multiApprovalError"}))},2e3);return}m&&f==="success"&&(setTimeout(()=>{N(!0)},3e3),setTimeout(()=>{n(R()),k(!T),n(F()),D(!1),N(null)},6e3))},[n,f,o,m,T]),s.useEffect(()=>{if(m&&h==="pending"&&E(!1),m&&h==="rejected"){setTimeout(()=>{E(null),b(!1),n(O())},3e3),setTimeout(()=>{var e,a;(a=(e=o==null?void 0:o.errorMessage)==null?void 0:e.message)==null||a.map(p=>I.error(p,{position:"top-right",theme:"dark",toastId:"multiRejectionError"}))},2e3);return}m&&h==="success"&&(setTimeout(()=>{E(!0)},3e3),setTimeout(()=>{E(null),k(!T),n(R()),n(O()),b(!1)},6e3))},[n,h,o,m,T]);const ce=`All Pending NT-Staff / Total = ${r==null?void 0:r.length}`;return t.jsxs(t.Fragment,{children:[t.jsxs(u,{component:"div",id:"adminDashboardHeaderWrap",sx:{position:"sticky",top:0,backgroundColor:"#fff",padding:0},minHeight:"4rem",children:[t.jsxs("h1",{className:"dashAction",children:[j==null?void 0:j.replace(/_/g,"-")," /"," ",t.jsx("span",{children:x==null?void 0:x.replace(/_/g," ")})]}),t.jsx(u,{sx:{display:{xs:"none",sm:"block"}},children:t.jsx(Ee,{value:c,onChange:X,placeholder:"Search"})})]}),t.jsxs(u,{className:"allAdminsData",id:"allAdmins",padding:{xs:" 1rem .5rem",sm:" 1rem"},children:[t.jsxs(u,{className:"searchDetails",children:[(r==null?void 0:r.length)===0&&c!==""&&t.jsxs("p",{className:"searchInfo",children:["We couldn't find any matches for '",c,"'"]}),(r==null?void 0:r.length)===0&&c!==""&&t.jsx("p",{style:{paddingLeft:"1.5rem",display:"flex",alignItems:"center",color:"red"},children:"||"}),c&&t.jsxs("p",{className:"searchInfo",children:["Search Result = ",r==null?void 0:r.length]}),!c&&t.jsxs("p",{className:"searchInfo",children:["Total NT-Staffs = ",i==null?void 0:i.length]})]}),t.jsx(u,{children:t.jsxs(_,{container:!0,spacing:3,className:"addNewAdminBtnsWrap",width:"100%",m:"0 auto",children:[H.map(e=>t.jsx(_,{component:"span",item:!0,xs:2.9,sm:2,onClick:()=>{e.label==="Add New NT-Staff +"?U(!0):w(`/sensec/users/${l==null?void 0:l.uniqueId}/admin/${j}/${x}/employees/${e.label.replace(/ /g,"_")}`)},className:(A==null?void 0:A.replace(/_/g," "))===e.label?"adminDashBtn isActive":(e==null?void 0:e.label)==="Add New NT-Staff +"?"adminDashAddBtn":"adminDashBtn",children:e.label==="All"?"All Employed NT-Staffs":e.label},e.label)),t.jsx(Te,{open:ee,onClose:()=>U(!1),handleNewEmployment:me,redirecting:V,uncompletedEmploymentTask:oe,question:"Are you sure you would like to employ a new NT-Staff?"})]})}),t.jsxs(u,{sx:{display:"flex",gap:1,fontSize:"calc(0.7rem + 1vmin)"},children:[t.jsx(ge,{approveMultiUsersDataStatus:f,approveMultiUsersDataLoadingComplete:J,multiUsersDataRejectionInProgress:Y,setMultiUsersDataApprovalInProgress:D,multiUsersDataApprovalFunction:he({employees:m,employmentApprovedBy:`${l==null?void 0:l.id}`})}),t.jsx(je,{rejectMultiUsersDataStatus:h,rejectMultiUsersDataLoadingComplete:K,multiUsersDataApprovalInProgress:Q,setMultiUsersDataRejectionInProgress:b,multiUsersDataApprovalFunction:Se({employees:m,employmentRejectedBy:`${l==null?void 0:l.id}`})})]}),t.jsx(u,{className:"lecturerDataTable",children:t.jsx(ye,{title:ce,columns:ie,data:r,customStyles:xe,pagination:!0,selectableRows:!0,fixedHeader:!0,selectableRowsHighlight:!0,highlightOnHover:!0,responsive:!0,onSelectedRowsChange:ne,clearSelectedRows:T})})]})]})}export{ot as PendingNTStaffs};
