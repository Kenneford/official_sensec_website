import{f as H,g as ce,e as ue,a as pe,u as de,r as t,cO as q,n as O,i as he,j as s,B as m}from"./index-BgAz6R-J.js";/* empty css                        */import{X as ge}from"./index.es-CbWliC7Q.js";import{H as fe}from"./react-router-hash-link.esm-BD8c6mys.js";import{c as xe}from"./usersInfoTableStyle-D7rSQ0GJ.js";import{d as Ne}from"./LinksFormat-DQzWvp0Y.js";import{F as Se,f as je}from"./FetchAllStudents-CKlFdhWm.js";import{F as $e}from"./FetchClassLevel-BNpuw00E.js";import{s as be}from"./UsersInfoDataFormat-C8uQnlpJ.js";import{S as Ie}from"./SearchFilter-BivGD2XO.js";import{F as De}from"./FetchClassSections-CITl_X_J.js";import{F as _e}from"./FetchProgrammeData-DNSy9I4u.js";import{N as we}from"./NewEnrollmentModal-Cde6Hjqk.js";import{G as I}from"./Grid-LFq3_oT1.js";import"./Edit-D4CNqQj2.js";import"./TaskAlt-bfh00-md.js";import"./SchoolOutlined-FRPh5Qka.js";import"./DateFormatter-B-8qT63H.js";import"./DemotionsModal-ukhU6vqu.js";import"./index-CCyO3jyY.js";import"./Close-C57ZU4ps.js";/* empty css                   */import"./Search-BzpM2Jt_.js";/* empty css               */import"./Stack-D3vGdk1Y.js";import"./styled-B4oIaKT5.js";import"./useThemeProps-JU6LSmm0.js";import"./getThemeProps-IXaZHU6q.js";function as(){const o=H(ce),R=Ne(),{promotionStatus:f,successMessage:D,error:$}=H(e=>e.promotion),b=ue(),_=pe(),{program:Te,class_level:a,adminCurrentLink:c,adminCurrentAction:u,student_category:x,programme:l}=de();_e();const w=$e(),i=Se(),h=De(),T=h==null?void 0:h.find(e=>(e==null?void 0:e.sectionName)===(l==null?void 0:l.replace(/_/g," "))&&(e==null?void 0:e.classLevelName)===(a==null?void 0:a.replace(/_/g," "))),g=je(T==null?void 0:T._id),[U,G]=t.useState(""),[W,X]=t.useState(""),[Y,Q]=t.useState(!1),[z,J]=t.useState(!1),[K,k]=t.useState(!1),[V,ke]=t.useState(!1),[Z,N]=t.useState(null),[L,v]=t.useState(null),[n,ee]=t.useState("");t.useState([]);const[se,P]=t.useState(!1),[te,oe]=t.useState(!1),[ae,ne]=t.useState(""),r=g==null?void 0:g.filter(e=>{var p,d,S,j,C,y,B,E,M,A;return((S=(d=(p=e==null?void 0:e.personalInfo)==null?void 0:p.firstName)==null?void 0:d.toLowerCase())==null?void 0:S.includes(n))||((C=(j=e==null?void 0:e.personalInfo)==null?void 0:j.firstName)==null?void 0:C.includes(n))||((E=(B=(y=e==null?void 0:e.personalInfo)==null?void 0:y.lastName)==null?void 0:B.toLowerCase())==null?void 0:E.includes(n))||((A=(M=e==null?void 0:e.personalInfo)==null?void 0:M.lastName)==null?void 0:A.includes(n))}),F=i==null?void 0:i.find(e=>(e==null?void 0:e._id)===U),re=i==null?void 0:i.find(e=>(e==null?void 0:e._id)===W),le=be({authAdmin:o,studentToPromote:F,adminCurrentAction:u,adminCurrentLink:c,setOpenPromotionModal:Q,openPromotionModal:Y,setCurrentStudent:G,setDemoteStudent:X,setLoadingComplete:N,loadingComplete:Z,setDemotionLoadingComplete:v,demotionLoadingComplete:L,demotionInProgress:V,promotionInProgress:K,setOpenDemotionModal:J,openDemotionModal:z,promotionStatus:f,studentToDemote:re}),ie=()=>{oe(!0),ne("You're being redirected"),setTimeout(()=>{_(`/sensec/users/${o==null?void 0:o.uniqueId}/admin/${u}/${c}/new_enrollment/placement_verification`)},3e3)};t.useEffect(()=>{if(F){if(f==="pending"&&(N(!1),k(!1)),f==="rejected"){setTimeout(()=>{N(null),k(!1),b(q())},3e3),setTimeout(()=>{var e,p;(p=(e=$==null?void 0:$.errorMessage)==null?void 0:e.message)==null||p.map(d=>O.error(d,{position:"top-right",theme:"light",toastId:d}))},2e3);return}f==="success"&&(setTimeout(()=>{N(!0)},3e3),setTimeout(()=>{O.success(D,{position:"top-right",theme:"dark",toastId:D})},1e3),setTimeout(()=>{b(he()),b(q()),k(!1),N(null)},6e3))}},[f,D,$,b,F]);const me=`${a==null?void 0:a.replace(/_/g," ")} ${l==null?void 0:l.replace(/_/g," ")} Students / Total = 
              ${g==null?void 0:g.length}`;return s.jsxs(s.Fragment,{children:[s.jsxs(m,{component:"div",id:"adminDashboardHeaderWrap",sx:{position:"sticky",top:0,backgroundColor:"#fff",padding:0},minHeight:"4rem",children:[s.jsxs("h1",{className:"dashAction",children:[u==null?void 0:u.replace(/_/g,"-")," /"," ",s.jsx("span",{children:c==null?void 0:c.replace(/_/g," ")})]}),s.jsx(m,{sx:{display:{xs:"none",sm:"block"}},children:s.jsx(Ie,{value:n,onChange:ee,placeholder:"Search"})})]}),s.jsxs(m,{className:"allStudentsData",id:"allStudents",padding:{xs:" 1rem .5rem",sm:" 1rem"},children:[s.jsxs(m,{className:"searchDetails",children:[(r==null?void 0:r.length)===0&&n!==""&&s.jsxs("p",{className:"searchInfo",children:[`We couldn't find any matches for "`,n,'"']}),(r==null?void 0:r.length)===0&&n!==""&&s.jsx("p",{style:{paddingLeft:"1.5rem",display:"flex",alignItems:"center",color:"red"},children:"||"}),n&&s.jsxs("p",{className:"searchInfo",children:["Total Enrolled Students Found = ",r==null?void 0:r.length]}),!n&&s.jsxs("p",{className:"searchInfo",children:["Total Students = ",i==null?void 0:i.length]})]}),s.jsx(m,{children:s.jsxs(I,{container:!0,spacing:3,className:"addNewStudentBtnsWrap",width:"100%",m:"0 auto",children:[R.map(e=>s.jsx(I,{component:"span",item:!0,xs:2.9,sm:2,onClick:()=>{e.label==="Add New Student +"?P(!0):_(`/sensec/users/${o==null?void 0:o.uniqueId}/admin/${u}/${c}/${e.label.replace(/ /g,"_")}`)},className:(x==null?void 0:x.replace(/_/g," "))===e.label?"studentDashBtn isActive":(e==null?void 0:e.label)==="Add New Student +"?"studentDashAddBtn":"studentDashBtn",children:e.label==="Enrolled"?"All Enrolled Students":e.label},e.label)),s.jsx(we,{open:se,onClose:()=>P(!1),handleNewEnrollment:ie,redirecting:te,uncompletedEmploymentTask:ae,question:"Are you sure you would like to enroll a new student?"})]})}),s.jsx(m,{children:s.jsx(I,{container:!0,spacing:3,width:"100%",m:"0 auto",className:"classLevelStudents",children:w==null?void 0:w.map(e=>s.jsx(I,{component:"span",item:!0,xs:2.9,sm:2,onClick:()=>_(`/sensec/users/${o==null?void 0:o.uniqueId}/admin/${u}/${c}/${x}/${e.name.replace(/ /g,"_")}`),className:(e==null?void 0:e.name)===(a==null?void 0:a.replace(/_/g," "))?"classLevelStudentsBtn isActive":"classLevelStudentsBtn",children:e.name},e._id))})}),s.jsx(m,{className:"classLeveSections",children:s.jsx(m,{className:"levelSections",children:h==null?void 0:h.map(e=>{var p,d,S,j;return s.jsx("span",{children:((p=e==null?void 0:e.classLevelName)==null?void 0:p.replace(/ /g,"_"))===a&&s.jsx(fe,{className:((d=e==null?void 0:e.classLevelName)==null?void 0:d.replace(/ /g,"_"))===a&&(e==null?void 0:e.sectionName)===(l==null?void 0:l.replace(/_/g," "))?"backgroundGreen":"backgroundYellow",to:`/sensec/users/${o==null?void 0:o.uniqueId}/admin/${u}/${c}/${x}/${(S=e==null?void 0:e.classLevelName)==null?void 0:S.replace(/ /g,"_")}/${(j=e.sectionName)==null?void 0:j.replace(/ /g,"_")}`,children:e==null?void 0:e.label})},e==null?void 0:e._id)})})}),s.jsx(m,{className:"studentDataTable",children:s.jsx(ge,{title:me,columns:le,data:r,customStyles:xe,pagination:!0,selectableRows:!0,selectableRowsHighlight:!0,highlightOnHover:!0})})]})]})}export{as as ClassLevelProgrammeStudents};
