import{e as je,a as ge,f as T,g as fe,u as pe,$ as ve,a0 as Ce,r as d,a1 as Ae,a2 as Ee,n as Ne,cK as re,j as r,B as b,T as le,l as se,d9 as We}from"./index-BrKZIgIs.js";import"./studentEnrollment-l0sNRNKZ.js";import{C as Ie,c as t,I as ie}from"./muiStyling-B8pUMTN3.js";import{F as Fe}from"./FetchProgrammeData-DzGaqZbQ.js";import{F as Te}from"./FetchClassLevel-4JV9FIfU.js";import{F as be}from"./FetchBatch--i32YoZ5.js";import{L as qe}from"./LoadingProgress-DyOM2CxY.js";import{R as Be}from"./Redirection-B8WeSLSt.js";import{b as ye}from"./FetchAllStudents-Bf4SUGYj.js";import{G as i}from"./Grid-CMH8KWik.js";import{M as s}from"./MenuItem-BVBtbdIH.js";import{A as Me}from"./Avatar-C5bx0TLE.js";import{T as Oe}from"./TaskAlt-CZKWz0j9.js";import"./FormLabel-C2cHTcFw.js";import"./index-DcfIKM1A.js";import"./useControlled-BPddiEUe.js";import"./useThemeProps-DJrrucl-.js";import"./getThemeProps-VIUuhX1y.js";import"./index-CXwWd3ii.js";import"./IconButton-D70T8NKk.js";function lr(){var L,Q,X,Z,S;const m=je(),q=ge(),h=T(fe),{studentIndexNo:D,adminCurrentAction:v,adminCurrentLink:C}=pe();localStorage.getItem("indexNumber");const f=Fe(),B=ye(),y=Te(),M=be(),c=T(ve),N=T(Ce),{enrollmentStatus:A,error:W,successMessage:ae}=T(l=>l.student),k=new Date().getFullYear();d.useState(Math.floor(1e4+Math.random()*9e4));const te=(()=>{const l=new Date().getFullYear(),n=2024,x=new Date().getMonth()>=8?l:l-1,F=[];for(let E=n;E<=x;E++)F.push(`${E}/${E+1}`);return F})(),[I,O]=d.useState(null),[R,ne]=d.useState(""),[Y,$]=d.useState(!1),[_,U]=d.useState(!1),[G,K]=d.useState(!1),[J,V]=d.useState(!1),[_e,z]=d.useState(!1),[j,oe]=d.useState("");console.log(j);const[e,H]=d.useState({uniqueId:j||"",firstName:"",lastName:"",otherName:"",dateOfBirth:"",placeOfBirth:"",nationality:"",gender:"",profilePicture:"",jhsAttended:"",completedJhs:"",jhsIndexNo:D,program:"",divisionProgram:"",optionalElectiveSubject:"",currentClassLevel:"",currentAcademicYear:"",batch:"",height:"",weight:"",complexion:"",motherTongue:"",otherTongue:"",residentialStatus:"",homeTown:"",district:"",region:"",currentCity:"",residentialAddress:"",gpsAddress:"",mobile:"",email:""});console.log(e);const de=(l,n)=>{var w,ee;const u=new Date().getFullYear(),x=l?(w=l==null?void 0:l.charAt(0))==null?void 0:w.toUpperCase():"",F=n?(ee=n==null?void 0:n.charAt(0))==null?void 0:ee.toUpperCase():"";return`STD-${Date.now().toString().slice(-5)}${x}${F}-${u}`};d.useEffect(()=>{const l=de(e==null?void 0:e.firstName,e==null?void 0:e.lastName);oe(l)},[e]);const ce=B==null?void 0:B.find(l=>{var n;return((n=l==null?void 0:l.studentSchoolData)==null?void 0:n.jhsIndexNo)===D});console.log(ce);const p=f==null?void 0:f.find(l=>(l==null?void 0:l._id)===(e==null?void 0:e.program)),g=c==null?void 0:c.find(l=>(l==null?void 0:l._id)===(e==null?void 0:e.divisionProgram)),[P,he]=d.useState(null),ue=l=>{const n=l.target.files[0],u=5*1024*1024;if(n.size>u){alert("File is too large! Please select a file smaller than 5MB.");return}l.target.files.length!==0&&H({...e,[l.target.name]:n});const x=new FileReader;x.readAsDataURL(l.target.files[0]),x.onloadend=()=>{he(x.result),H({...e,profilePicture:x.result})}},a=l=>{const{name:n,value:u}=l.target;H({...e,[n]:u})},xe=e!=null&&e.dateOfBirth?new Date(e==null?void 0:e.dateOfBirth).toISOString():"",me=l=>{l.preventDefault(),m(We({studentId:j,newStudent:e,dateOfBirth:xe}))},o=d.useMemo(()=>N==null?void 0:N.find(n=>(n==null?void 0:n.jhsIndexNo)===(e==null?void 0:e.jhsIndexNo)),[N,e]);return d.useEffect(()=>{e!=null&&e.program&&m(Ae({programId:e==null?void 0:e.program})),m(Ee())},[m,e]),d.useEffect(()=>{if(o&&(e!=null&&e.firstName)&&(o==null?void 0:o.firstName)!==(e==null?void 0:e.firstName)){$(!0);return}else $(!1);if(o&&(e!=null&&e.lastName)&&(o==null?void 0:o.lastName)!==(e==null?void 0:e.lastName)){U(!0);return}else U(!1);if(o&&(e!=null&&e.jhsAttended)&&(o==null?void 0:o.jhsAttended)!==(e==null?void 0:e.jhsAttended)){K(!0);return}else K(!1);if(o&&(e!=null&&e.completedJhs)&&(o==null?void 0:o.yearGraduated)!==(e==null?void 0:e.completedJhs)){V(!0);return}else V(!1);if(e!=null&&e.jhsIndexNo&&!o){z(!0);return}else z(!1)},[e,o]),d.useEffect(()=>{if(A==="pending"&&O(!1),A==="rejected"){setTimeout(()=>{var l,n;(n=(l=W==null?void 0:W.errorMessage)==null?void 0:l.message)==null||n.map(u=>Ne.error(u,{position:"top-right",theme:"light",toastId:u}))},2e3),setTimeout(()=>{O(null),m(re())},3e3);return}A==="success"&&(setTimeout(()=>{O(!0)},3e3),setTimeout(()=>{ne(!0),m(re())},6e3),setTimeout(()=>{var l;(l=h==null?void 0:h.roles)!=null&&l.includes("admin")?q(`/sensec/users/${h==null?void 0:h.uniqueId}/admin/User-Types/Students/${j}/new_enrollment/parent/add`):q(`/sensec/students/enrollment/online/${j}/parent/add`)},9e3))},[q,m,A,W,ae,I,e,v,C,h,j]),r.jsxs(r.Fragment,{children:[v&&C&&r.jsx(b,{component:"div",id:"adminDashboardHeaderWrap",sx:{position:"sticky",top:0,backgroundColor:"#fff",padding:0},minHeight:"4rem",children:r.jsxs("h1",{className:"dashAction",children:[v==null?void 0:v.replace(/_/g,"-")," /"," ",r.jsx("span",{children:C==null?void 0:C.replace(/_/g," ")})]})}),r.jsxs(Ie,{component:"div",id:"studentEnrollmentWrap",sx:{width:{xs:"100%",sm:"95%",md:"90%",lg:"90%",xl:"75%"},margin:"auto",paddingTop:"2rem",display:"flex",flexDirection:"column",position:"relative"},children:[r.jsx(le,{variant:"h6",fontSize:{xs:"1.2rem",sm:"1.2rem",md:"1.4rem",lg:"1.7rem"},textAlign:"center",color:"#696969",children:"Student Online Enrollment"}),r.jsxs(le,{textAlign:"center",color:"#696969",children:["("," ",r.jsxs("span",{style:{fontWeight:"500"},children:[k,"/",k+1]})," ","Academic Year )"]}),r.jsx(b,{component:"div",id:"enrollmentFormWrap",sx:{maxWidth:1e3,mx:"auto",mt:5,p:3,border:"1px solid #ccc",borderRadius:"8px",backgroundColor:"#f9f9f9"},children:r.jsx("form",{onSubmit:me,style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",gap:"2rem",padding:".5rem 0"},children:r.jsxs(i,{container:!0,spacing:3,children:[r.jsx(i,{item:!0,xs:12,sm:6,md:4,lg:4,children:r.jsx(t,{fullWidth:!0,label:"First Name",name:"firstName",value:e==null?void 0:e.firstName,onChange:a,required:!0,className:"textField",error:Y,helperText:Y?"First name is not correct!":"",sx:{"& .MuiInputLabel-asterisk":{color:e!=null&&e.firstName&&!Y?"green":"red"}}})}),r.jsx(i,{item:!0,xs:12,sm:6,md:4,lg:4,children:r.jsx(t,{fullWidth:!0,label:"Surname",name:"lastName",value:e==null?void 0:e.lastName,onChange:a,required:!0,error:_,helperText:_?"Surname is not correct!":"",sx:{"& .MuiInputLabel-asterisk":{color:e!=null&&e.lastName&&!_?"green":"red"}}})}),r.jsx(i,{item:!0,xs:12,sm:6,md:4,lg:4,children:r.jsx(t,{fullWidth:!0,label:"Other Name",name:"otherName",value:e==null?void 0:e.otherName,onChange:a})}),r.jsx(i,{item:!0,xs:12,sm:6,md:4,lg:4,children:r.jsx(t,{fullWidth:!0,label:"Place Of Birth",name:"placeOfBirth",value:e==null?void 0:e.placeOfBirth,onChange:a,required:!0})}),r.jsx(i,{item:!0,xs:12,sm:6,md:4,lg:4,children:r.jsx(t,{fullWidth:!0,name:"dateOfBirth",type:"date",value:(e==null?void 0:e.dateOfBirth)||"",onChange:a,required:!0})}),r.jsx(i,{item:!0,xs:12,sm:6,md:4,lg:4,children:r.jsx(t,{fullWidth:!0,label:"Nationality",name:"nationality",value:e==null?void 0:e.nationality,onChange:a,required:!0})}),r.jsx(i,{item:!0,xs:12,sm:6,md:4,lg:4,children:r.jsxs(t,{select:!0,fullWidth:!0,label:"Gender",name:"gender",value:e==null?void 0:e.gender,onChange:a,required:!0,children:[r.jsx(s,{value:"Male",children:"Male"}),r.jsx(s,{value:"Female",children:"Female"})]})}),r.jsx(i,{item:!0,xs:12,sm:6,md:4,lg:4,children:r.jsxs(t,{select:!0,fullWidth:!0,label:"Mother Tongue",name:"motherTongue",value:e==null?void 0:e.motherTongue,onChange:a,required:!0,children:[r.jsx(s,{value:"Twi",children:"Twi"}),r.jsx(s,{value:"Fante",children:"Fante"}),r.jsx(s,{value:"Ga",children:"Ga"}),r.jsx(s,{value:"Ewe",children:"Ewe"}),r.jsx(s,{value:"Nzema",children:"Nzema"}),r.jsx(s,{value:"Hausa",children:"Hausa"}),r.jsx(s,{value:"Gonja",children:"Gonja"}),r.jsx(s,{value:"Kwa",children:"Kwa"}),r.jsx(s,{value:"Dagbani",children:"Dagbani"}),r.jsx(s,{value:"Dagaare",children:"Dagaare"}),r.jsx(s,{value:"Kulango",children:"Kulango"}),r.jsx(s,{value:"Senufo",children:"Senufo"}),r.jsx(s,{value:"Mande",children:"Mande"}),r.jsx(s,{value:"Dangme",children:"Dangme"}),r.jsx(s,{value:"other",children:"Other"})]})}),r.jsx(i,{item:!0,xs:12,sm:6,md:4,lg:4,children:r.jsxs(t,{select:!0,fullWidth:!0,label:"Other Tongue",name:"otherTongue",value:e==null?void 0:e.otherTongue,onChange:a,children:[r.jsx(s,{value:"English",children:"English"}),r.jsx(s,{value:"French",children:"French"}),r.jsx(s,{value:"Spanish",children:"Spanish"}),r.jsx(s,{value:"Deutsch",children:"Deutsch"}),r.jsx(s,{value:"Italian",children:"Italian"}),r.jsx(s,{value:"Arabic",children:"Arabic"}),r.jsx(s,{value:"other",children:"Other"})]})}),r.jsx(i,{item:!0,xs:12,sm:6,md:4,lg:4,children:r.jsxs(t,{select:!0,fullWidth:!0,label:"Complexion",name:"complexion",value:e==null?void 0:e.complexion,onChange:a,required:!0,children:[r.jsx(s,{value:"Very Fair",children:"Very Fair"}),r.jsx(s,{value:"Fair",children:"Fair"}),r.jsx(s,{value:"Medium",children:"Medium"}),r.jsx(s,{value:"Olive",children:"Olive"}),r.jsx(s,{value:"Brown",children:"Brown"}),r.jsx(s,{value:"Black",children:"Black"})]})}),r.jsx(i,{item:!0,xs:12,sm:6,md:4,lg:4,children:r.jsx(t,{fullWidth:!0,label:"Height",name:"height",value:e==null?void 0:e.height,onChange:a,required:!0,slotProps:{input:{endAdornment:r.jsx(ie,{position:"end",children:"ft"})}}})}),r.jsx(i,{item:!0,xs:12,sm:6,md:4,lg:4,children:r.jsx(t,{fullWidth:!0,label:"Weight",name:"weight",value:e==null?void 0:e.weight,onChange:a,required:!0,slotProps:{input:{endAdornment:r.jsx(ie,{position:"end",children:"kg"})}}})}),r.jsx(i,{item:!0,xs:12,sm:6,md:4,lg:4,children:r.jsxs(t,{fullWidth:!0,select:!0,label:"Region",name:"region",value:e==null?void 0:e.region,onChange:a,required:!0,children:[r.jsx(s,{value:"Greater Accra",children:"Greater Accra"}),r.jsx(s,{value:"Ashanti",children:"Ashanti"}),r.jsx(s,{value:"Volta",children:"Volta"}),r.jsx(s,{value:"Central",children:"Central"}),r.jsx(s,{value:"Eastern",children:"Eastern"}),r.jsx(s,{value:"Western",children:"Western"}),r.jsx(s,{value:"Oti",children:"Oti"}),r.jsx(s,{value:"Bono",children:"Bono"}),r.jsx(s,{value:"Bono East",children:"Bono East"}),r.jsx(s,{value:"Ahafo",children:"Ahafo"}),r.jsx(s,{value:"Brong Ahafo",children:"Brong Ahafo"}),r.jsx(s,{value:"Northern",children:"Northern"}),r.jsx(s,{value:"Western North",children:"Western North"}),r.jsx(s,{value:"Upper West",children:"Upper West"}),r.jsx(s,{value:"Upper East",children:"Upper East"}),r.jsx(s,{value:"North East",children:"North East"})]})}),r.jsx(i,{item:!0,xs:12,sm:6,md:4,lg:4,children:r.jsx(t,{fullWidth:!0,label:"HomeTown",name:"homeTown",value:e==null?void 0:e.homeTown,onChange:a,required:!0})}),r.jsx(i,{item:!0,xs:12,sm:6,md:4,lg:4,children:r.jsx(t,{fullWidth:!0,label:"House Address",name:"residentialAddress",value:e==null?void 0:e.residentialAddress,onChange:a,required:!0})}),r.jsx(i,{item:!0,xs:12,sm:6,md:4,lg:4,children:r.jsx(t,{fullWidth:!0,label:"District",name:"district",value:e==null?void 0:e.district,onChange:a,required:!0})}),r.jsx(i,{item:!0,xs:12,sm:6,md:4,lg:4,children:r.jsx(t,{fullWidth:!0,label:"Current City",name:"currentCity",value:e==null?void 0:e.currentCity,onChange:a,required:!0})}),r.jsx(i,{item:!0,xs:12,sm:6,md:4,lg:4,children:r.jsx(t,{fullWidth:!0,label:"GPS Address",name:"gpsAddress",value:e==null?void 0:e.gpsAddress,onChange:a,required:!0})}),r.jsx(i,{item:!0,xs:12,sm:6,md:4,lg:4,children:r.jsx(t,{fullWidth:!0,label:"Email",name:"email",value:e==null?void 0:e.email,onChange:a,required:!0})}),r.jsx(i,{item:!0,xs:12,sm:6,md:4,lg:4,children:r.jsx(t,{fullWidth:!0,label:"Mobile",name:"mobile",value:e==null?void 0:e.mobile,onChange:a,required:!0})}),r.jsx(i,{item:!0,xs:12,sm:6,md:4,lg:4,children:r.jsx(t,{fullWidth:!0,label:"JHS Attended",name:"jhsAttended",value:e==null?void 0:e.jhsAttended,onChange:a,required:!0,error:G,helperText:G?"JHS attended is not correct!":"",sx:{"& .MuiInputLabel-asterisk":{color:e!=null&&e.jhsAttended&&!G?"green":"red"}}})}),r.jsx(i,{item:!0,xs:12,sm:6,md:4,lg:4,children:r.jsx(t,{fullWidth:!0,label:"Year Graduated [ JHS ]",name:"completedJhs",value:e==null?void 0:e.completedJhs,onChange:a,required:!0,error:J,helperText:J?"Graduated year is not correct!":"",sx:{"& .MuiInputLabel-asterisk":{color:e!=null&&e.completedJhs&&!J?"green":"red"}}})}),r.jsx(i,{item:!0,xs:12,sm:6,md:4,lg:4,children:r.jsx(t,{fullWidth:!0,label:"JHS Index No.",name:"jhsIndexNo",value:e==null?void 0:e.jhsIndexNo,onChange:a,disabled:!h||h&&((L=h==null?void 0:h.roles)==null?void 0:L.includes("admin"))})}),r.jsx(i,{item:!0,xs:12,sm:6,md:4,lg:4,children:r.jsx(t,{select:!0,fullWidth:!0,label:"Select Programme",name:"program",value:e==null?void 0:e.program,onChange:a,required:!0,children:f==null?void 0:f.map(l=>r.jsx(s,{value:l==null?void 0:l._id,children:l==null?void 0:l.name},l==null?void 0:l._id))})}),c&&(c==null?void 0:c.length)>0&&r.jsx(i,{item:!0,xs:12,sm:6,md:4,lg:4,children:r.jsx(t,{select:!0,fullWidth:!0,label:"Division Program",name:"divisionProgram",value:e==null?void 0:e.divisionProgram,onChange:a,children:c==null?void 0:c.map(l=>r.jsx(s,{value:l==null?void 0:l._id,children:l==null?void 0:l.divisionName},l==null?void 0:l._id))})}),g&&((Q=g==null?void 0:g.optionalElectiveSubjects)==null?void 0:Q.length)>0&&r.jsx(i,{item:!0,xs:12,sm:6,md:4,lg:4,children:r.jsx(t,{select:!0,fullWidth:!0,label:"Optional Elective Subject",name:"optionalElectiveSubject",value:e==null?void 0:e.optionalElectiveSubject,onChange:a,required:!0,children:(X=g==null?void 0:g.optionalElectiveSubjects)==null?void 0:X.map(l=>r.jsx(s,{value:l==null?void 0:l._id,children:l==null?void 0:l.subjectName},l==null?void 0:l._id))})}),c&&!(c!=null&&c.length)>0&&((Z=p==null?void 0:p.optionalElectiveSubjects)==null?void 0:Z.length)>0&&r.jsx(i,{item:!0,xs:12,sm:6,md:4,lg:4,children:r.jsx(t,{select:!0,fullWidth:!0,label:"Optional Elective Subject",name:"optionalElectiveSubject",value:e==null?void 0:e.optionalElectiveSubject,onChange:a,required:!0,children:(S=p==null?void 0:p.optionalElectiveSubjects)==null?void 0:S.map(l=>r.jsx(s,{value:l==null?void 0:l._id,children:l==null?void 0:l.subjectName},l==null?void 0:l._id))})}),r.jsx(i,{item:!0,xs:12,sm:6,md:4,lg:4,children:r.jsx(t,{select:!0,fullWidth:!0,label:"Class Level",name:"currentClassLevel",value:e==null?void 0:e.currentClassLevel,onChange:a,required:!0,children:y==null?void 0:y.map(l=>r.jsx(s,{value:l==null?void 0:l._id,children:l==null?void 0:l.name},l==null?void 0:l._id))})}),r.jsx(i,{item:!0,xs:12,sm:6,md:4,lg:4,children:r.jsx(t,{select:!0,fullWidth:!0,label:"Batch",name:"batch",value:e==null?void 0:e.batch,onChange:a,required:!0,children:M==null?void 0:M.map(l=>r.jsx(s,{value:l==null?void 0:l._id,children:l==null?void 0:l.yearRange},l==null?void 0:l._id))})}),r.jsx(i,{item:!0,xs:12,sm:6,md:4,lg:4,children:r.jsx(t,{select:!0,fullWidth:!0,label:"Academic Year",name:"currentAcademicYear",value:e==null?void 0:e.currentAcademicYear,onChange:a,required:!0,children:te.map(l=>r.jsx(s,{value:l,children:l},l))})}),r.jsx(i,{item:!0,xs:12,sm:6,md:4,lg:4,children:r.jsxs(t,{select:!0,fullWidth:!0,label:"Residential Status",name:"residentialStatus",value:e==null?void 0:e.residentialStatus,onChange:a,required:!0,children:[r.jsx(s,{value:"Day",children:"Day"}),r.jsx(s,{value:"Boarding",children:"Boarding"}),r.jsx(s,{value:"Hostel",children:"Hostel"}),r.jsx(s,{value:"Private",children:"Private"}),r.jsx(s,{value:"Lecturers Bangalow",children:"Lecturers Bangalow"})]})}),r.jsx(i,{item:!0,xs:12,children:r.jsxs(b,{sx:{display:"flex",justifyContent:"center",alignItems:"center"},children:[r.jsx(i,{item:!0,xs:12,sm:4,children:r.jsxs(se,{variant:"contained",component:"label",fullWidth:!0,sx:{textTransform:"capitalize",backgroundColor:"#292929",padding:"1rem"},children:["Upload Image",r.jsx("input",{type:"file",hidden:!0,accept:"image/*",onChange:ue})]})}),r.jsx(i,{item:!0,xs:12,sm:4,children:P&&r.jsx(b,{display:"flex",justifyContent:"center",alignItems:"center",height:"100%",children:r.jsx(Me,{src:P,alt:"Profile Preview",sx:{width:"6rem",height:"6rem",borderRadius:".4rem",border:"1px solid #696969",padding:".2rem"}})})})]})}),r.jsx(i,{item:!0,xs:12,children:r.jsxs(se,{variant:"contained",color:"success",type:"submit",fullWidth:!0,sx:{height:"3.5rem",letterSpacing:"1px",textTransform:"capitalize",fontSize:"1.2rem"},children:[I===!1&&r.jsx(qe,{color:"#fff",size:"1.5rem"}),I===!0&&A==="success"&&!R&&r.jsxs(r.Fragment,{children:[r.jsx("span",{children:"Successful"})," ",r.jsx(Oe,{})]}),I===null&&"Submit Enrollment",R&&r.jsx(Be,{color:"#fff",size:"1.5rem"})]})})]})})})]})]})}export{lr as EnrollmentForm};
