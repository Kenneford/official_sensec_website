import{f as q,g as Ce,e as $e,a as we,u as be,r as s,cO as A,n as H,i as Te,j as t,B as g,cX as _e,cY as ke,cZ as Be}from"./index-BgAz6R-J.js";/* empty css                        */import{X as ye}from"./index.es-CbWliC7Q.js";import{H as Ee}from"./react-router-hash-link.esm-BD8c6mys.js";import{c as Fe}from"./usersInfoTableStyle-D7rSQ0GJ.js";import{d as Re}from"./LinksFormat-DQzWvp0Y.js";import{F as qe,d as Ae}from"./FetchAllStudents-CKlFdhWm.js";import{F as He}from"./FetchClassLevel-BNpuw00E.js";import{s as Oe}from"./UsersInfoDataFormat-C8uQnlpJ.js";import{S as Ue}from"./SearchFilter-BivGD2XO.js";import{F as Ge}from"./FetchClassSections-CITl_X_J.js";import{N as We}from"./NewEnrollmentModal-Cde6Hjqk.js";import{G as M}from"./Grid-LFq3_oT1.js";import"./Edit-D4CNqQj2.js";import"./TaskAlt-bfh00-md.js";import"./SchoolOutlined-FRPh5Qka.js";import"./DateFormatter-B-8qT63H.js";import"./DemotionsModal-ukhU6vqu.js";import"./index-CCyO3jyY.js";import"./Close-C57ZU4ps.js";/* empty css                   */import"./Search-BzpM2Jt_.js";/* empty css               */import"./Stack-D3vGdk1Y.js";import"./styled-B4oIaKT5.js";import"./useThemeProps-JU6LSmm0.js";import"./getThemeProps-IXaZHU6q.js";function Nt(){const o=q(Ce),O=Re(),{promotionStatus:x,multiStudentsPromotionStatus:U,multiStudentsDemotionStatus:G,successMessage:D,error:N}=q(e=>e.promotion),P=$e(),C=we(),{program:W,class_level:n,adminCurrentLink:c,adminCurrentAction:p,student_category:j}=be(),[X,Y]=s.useState(""),[Q,Z]=s.useState(""),[z,J]=s.useState(!1),[K,V]=s.useState(!1),[L,$]=s.useState(!1),[v,Xe]=s.useState(!1),[ee,I]=s.useState(null),[te,se]=s.useState(null),[r,oe]=s.useState(""),[ne,T]=s.useState(!1),[ae,re]=s.useState(!1),[ie,le]=s.useState(""),S=He(),w=Ge(),m=qe(),h=S==null?void 0:S.find(e=>(e==null?void 0:e.name)===(n==null?void 0:n.replace(/_/g," "))),u=Ae(h==null?void 0:h._id),[me,Ye]=s.useState("");s.useState(null),s.useState(null),s.useState(null);const[ue,de]=s.useState(null),[ce,pe]=s.useState(!1),[ge,Se]=s.useState(!1),[he,fe]=s.useState(null),b=m==null?void 0:m.find(e=>(e==null?void 0:e._id)===X),xe=m==null?void 0:m.find(e=>(e==null?void 0:e._id)===Q),i=u==null?void 0:u.filter(e=>{var a,l,d,f,k,B,y,E,F,R;return((d=(l=(a=e==null?void 0:e.personalInfo)==null?void 0:a.firstName)==null?void 0:l.toLowerCase())==null?void 0:d.includes(r))||((k=(f=e==null?void 0:e.personalInfo)==null?void 0:f.firstName)==null?void 0:k.includes(r))||((E=(y=(B=e==null?void 0:e.personalInfo)==null?void 0:B.lastName)==null?void 0:y.toLowerCase())==null?void 0:E.includes(r))||((R=(F=e==null?void 0:e.personalInfo)==null?void 0:F.lastName)==null?void 0:R.includes(r))});u==null||u.find(e=>e._id===me);const je=()=>{re(!0),le("You're being redirected"),setTimeout(()=>{C(`/sensec/users/${o==null?void 0:o.uniqueId}/admin/${p}/${c}/new_enrollment/placement_verification`)},3e3)},Ie=Oe({authAdmin:o,studentToPromote:b,adminCurrentAction:p,adminCurrentLink:c,setOpenPromotionModal:J,openPromotionModal:z,setCurrentStudent:Y,setDemoteStudent:Z,setLoadingComplete:I,loadingComplete:ee,setDemotionLoadingComplete:se,demotionLoadingComplete:te,demotionInProgress:v,promotionInProgress:L,setOpenDemotionModal:V,openDemotionModal:K,promotionStatus:x,studentToDemote:xe}),[Ne,_]=s.useState([]),[Pe,Ze]=s.useState(!1),Me=e=>{var a;if(e){const l=(a=e==null?void 0:e.selectedRows)==null?void 0:a.map(d=>({uniqueId:d==null?void 0:d.uniqueId}));_(l)}else _([])};s.useEffect(()=>{if(b){if(x==="pending"&&(I(!1),$(!1)),x==="rejected"){setTimeout(()=>{I(null),$(!1),P(A())},3e3),setTimeout(()=>{var e,a;(a=(e=N==null?void 0:N.errorMessage)==null?void 0:e.message)==null||a.map(l=>H.error(l,{position:"top-right",theme:"light",toastId:l}))},2e3);return}x==="success"&&(setTimeout(()=>{I(!0)},3e3),setTimeout(()=>{H.success(D,{position:"top-right",theme:"dark",toastId:D})},1e3),setTimeout(()=>{P(Te()),P(A()),$(!1),I(null)},6e3))}},[x,D,N,P,b]);const De=`${n==null?void 0:n.replace(/_/g," ")} Enrolled Students / Total = 
              ${u==null?void 0:u.length}`;return t.jsxs(t.Fragment,{children:[t.jsxs(g,{component:"div",id:"adminDashboardHeaderWrap",sx:{position:"sticky",top:0,backgroundColor:"#fff",padding:0},minHeight:"4rem",children:[t.jsxs("h1",{className:"dashAction",children:[p==null?void 0:p.replace(/_/g,"-")," /"," ",t.jsx("span",{children:c==null?void 0:c.replace(/_/g," ")})]}),t.jsx(g,{sx:{display:{xs:"none",sm:"block"}},children:t.jsx(Ue,{value:r,onChange:oe,placeholder:"Search"})})]}),t.jsxs(g,{className:"allStudentsData",id:"allStudents",padding:{xs:" 1rem .5rem",sm:" 1rem"},children:[t.jsxs(g,{className:"searchDetails",children:[(i==null?void 0:i.length)===0&&r!==""&&t.jsxs("p",{className:"searchInfo",children:[`We couldn't find any matches for "`,r,'"']}),(i==null?void 0:i.length)===0&&r!==""&&t.jsx("p",{style:{paddingLeft:"1.5rem",display:"flex",alignItems:"center",color:"red"},children:"||"}),r&&t.jsxs("p",{className:"searchInfo",children:["Total Enrolled Students Found = ",i==null?void 0:i.length]}),!r&&t.jsxs("p",{className:"searchInfo",children:["Total Students = ",m==null?void 0:m.length]})]}),t.jsx(g,{children:t.jsxs(M,{container:!0,spacing:3,className:"addNewStudentBtnsWrap",width:"100%",m:"0 auto",children:[O.map(e=>t.jsx(M,{component:"span",item:!0,xs:2.9,sm:2,onClick:()=>{e.label==="Add New Student +"?T(!0):C(`/sensec/users/${o==null?void 0:o.uniqueId}/admin/${p}/${c}/${e.label.replace(/ /g,"_")}`)},className:(j==null?void 0:j.replace(/_/g," "))===e.label?"studentDashBtn isActive":(e==null?void 0:e.label)==="Add New Student +"?"studentDashAddBtn":"studentDashBtn",children:e.label==="Enrolled"?"All Enrolled Students":e.label},e.label)),t.jsx(We,{open:ne,onClose:()=>T(!1),handleNewEnrollment:je,redirecting:ae,uncompletedEmploymentTask:ie,question:"Are you sure you would like to enroll a new student?"})]})}),t.jsx(g,{children:t.jsx(M,{container:!0,spacing:3,width:"100%",m:"0 auto",className:"classLevelStudents",children:S==null?void 0:S.map(e=>t.jsx(M,{component:"span",item:!0,xs:2.9,sm:2,onClick:()=>C(`/sensec/users/${o==null?void 0:o.uniqueId}/admin/${p}/${c}/${j}/${e.name.replace(/ /g,"_")}`),className:(e==null?void 0:e.name)===(n==null?void 0:n.replace(/_/g," "))?"classLevelStudentsBtn isActive":"classLevelStudentsBtn",children:e.name},e._id))})}),t.jsx("div",{className:"classLeveSections",children:t.jsx("div",{className:"levelSections",children:w==null?void 0:w.map(e=>{var a,l,d,f;return t.jsx("span",{children:((a=e==null?void 0:e.classLevelName)==null?void 0:a.replace(/ /g,"_"))===n&&t.jsx(Ee,{className:((l=e==null?void 0:e.classLevelName)==null?void 0:l.replace(/ /g,"_"))===n&&(e==null?void 0:e.sectionName)===W?"backgroundGreen":"backgroundYellow",to:`/sensec/users/${o==null?void 0:o.uniqueId}/admin/${p}/${c}/${j}/${(d=e==null?void 0:e.classLevelName)==null?void 0:d.replace(/ /g,"_")}/${(f=e.sectionName)==null?void 0:f.replace(/ /g,"_")}`,children:e==null?void 0:e.label})},e==null?void 0:e._id)})})}),t.jsxs(g,{sx:{display:"flex",gap:1},children:[t.jsx(_e,{promoteMultiStudentsStatus:U,promoteMultiStudentsLoadingComplete:ue,setPromoteMultiLoadingComplete:de,multiStudentsDemotionInProgress:ge,setMultiStudentsPromotionInProgress:pe,multiStudentsPromotionFunction:ke({students:Ne,classLevel:`${h==null?void 0:h.name}`,lastPromotedBy:`${o==null?void 0:o.id}`})}),t.jsx(Be,{demoteMultiStudentsStatus:G,demoteMultiStudentsLoadingComplete:he,setDemoteMultiLoadingComplete:fe,multiStudentsPromotionInProgress:ce,setMultiStudentsDemotionInProgress:Se})]}),t.jsx(g,{className:"studentDataTable",children:t.jsx(ye,{title:De,columns:Ie,data:i,customStyles:Fe,pagination:!0,selectableRows:!0,selectableRowsHighlight:!0,highlightOnHover:!0,onSelectedRowsChange:Me,clearSelectedRows:Pe})})]})]})}export{Nt as ClassLevelStudents};
