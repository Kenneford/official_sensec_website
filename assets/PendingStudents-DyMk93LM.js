import{f as V,g as Ne,a as Ae,u as De,r as s,e as be,cR as Y,n as R,i as N,cS as z,cT as J,cU as K,j as t,B as p,cG as ye,cV as Ue,cI as $e,cW as Be}from"./index-CL8aB76r.js";/* empty css                        */import{X as ke}from"./index.es-BbMtkD1E.js";import{c as Fe}from"./usersInfoTableStyle-D7rSQ0GJ.js";import{d as Pe}from"./LinksFormat-DQzWvp0Y.js";import{c as Le,F as _e}from"./FetchAllStudents-DcT4Vh_v.js";import{F as qe}from"./FetchClassLevel-Bq1fN1Fd.js";import{d as Oe}from"./UsersInfoDataFormat-Bi18O2Bc.js";import{N as He}from"./NewEnrollmentModal-Cczk8Wir.js";import{S as We}from"./SearchFilter-CgDWyRwC.js";import{G as A}from"./Grid-C0sdyGW0.js";import"./react-router-hash-link.esm-B89W9L0I.js";import"./Edit-kyd4yOMZ.js";import"./TaskAlt-S5e9RsjI.js";import"./SchoolOutlined-DO3mvWS8.js";import"./DateFormatter-B-8qT63H.js";import"./DemotionsModal-C2-M0s41.js";import"./index-C29gN_Wn.js";import"./Close-DXFNgs9K.js";/* empty css               */import"./Stack-DmUJKXZk.js";import"./styled-DCaZBxMP.js";import"./useThemeProps-5fjUjDwy.js";import"./getThemeProps-BQ9MDSVY.js";/* empty css                   */import"./Search-QY5huDaQ.js";function jt(){const o=V(Ne),Z=Pe(),r=Le(),D=_e(),b=Ae(),{class_level:y,adminCurrentLink:d,adminCurrentAction:f,student_category:w}=De(),{enrollmentApprovalStatus:S,successMessage:U,error:l,approveMultiEnrollmentStatus:g,rejectEnrollmentStatus:j,rejectMultiEnrollmentStatus:x}=V(e=>e.student),[c,ee]=s.useState(""),[te,M]=s.useState(null),[se,$]=s.useState(!1),[oe,B]=s.useState(!1),[ae,I]=s.useState(null),[le,E]=s.useState(null),[ne,T]=s.useState(!1),[re,ie]=s.useState(!1),[ce,C]=s.useState(null),[ue,me]=s.useState(!1),[pe,de]=s.useState(!1),[fe,ge]=s.useState(""),[he,Se]=s.useState(""),[je,L]=s.useState(!1),[xe,Me]=s.useState(!1),[Ie,Te]=s.useState(""),a=be(),ve=qe(),u=r==null?void 0:r.filter(e=>{var n,i,h,P,O,H,W,G,X,Q;return((h=(i=(n=e==null?void 0:e.personalInfo)==null?void 0:n.firstName)==null?void 0:i.toLowerCase())==null?void 0:h.includes(c))||((O=(P=e==null?void 0:e.personalInfo)==null?void 0:P.firstName)==null?void 0:O.includes(c))||((G=(W=(H=e==null?void 0:e.personalInfo)==null?void 0:H.lastName)==null?void 0:W.toLowerCase())==null?void 0:G.includes(c))||((Q=(X=e==null?void 0:e.personalInfo)==null?void 0:X.lastName)==null?void 0:Q.includes(c))&&e}),k=r==null?void 0:r.find(e=>e._id===fe),F=r==null?void 0:r.find(e=>e._id===he),[m,_]=s.useState([]),[v,q]=s.useState(!1),Re=e=>{var n;if(e){const i=(n=e==null?void 0:e.selectedRows)==null?void 0:n.map(h=>({uniqueId:h==null?void 0:h.uniqueId}));_(i)}else _([])},we=Oe({authAdmin:o,setCurrentStudent:ge,loadingComplete:te,setLoadingComplete:M,rejectLoadingComplete:ae,setRejectLoadingComplete:I,foundStudent:k,enrollmentApprovalStatus:S,openApproveEnrollmentModal:ue,setOpenApproveEnrollmentModal:me,setRejectStudent:Se,studentToReject:F,openRejectModal:pe,setOpenRejectModal:de,rejectEnrollmentStatus:j,adminCurrentAction:f,adminCurrentLink:d,approvalInProgress:se,rejectionInProgress:oe});window.location.hash&&window.history.replaceState("",document.title,window.location.pathname);const Ee=()=>{Me(!0),Te("You're being redirected"),setTimeout(()=>{b(`/sensec/users/${o==null?void 0:o.uniqueId}/admin/${f}/${d}/new_enrollment/placement_verification`)},3e3)};s.useEffect(()=>{if(k){if(S==="pending"&&(M(!1),$(!1),setTimeout(()=>{M(!0)},3e3)),S==="rejected"){setTimeout(()=>{M(null),$(!1),a(Y())},3e3),setTimeout(()=>{var e,n;(n=(e=l==null?void 0:l.errorMessage)==null?void 0:e.message)==null||n.map(i=>R.error(i,{position:"top-right",theme:"light",toastId:i}))},2e3);return}S==="success"&&(setTimeout(()=>{R.success(U,{position:"top-right",theme:"dark",toastId:U})},1e3),setTimeout(()=>{a(N()),a(Y()),$(!1),M(null)},6e3))}},[S,U,l,a,k]),s.useEffect(()=>{if(F){if(j==="pending"&&(I(!1),B(!0)),j==="rejected"){setTimeout(()=>{I(null),B(!1),a(z())},3e3),setTimeout(()=>{l.errorMessage.message.map(e=>R.error(e,{position:"top-right",theme:"dark"}))},2e3);return}j==="success"&&(setTimeout(()=>{I(!0)},3e3),setTimeout(()=>{I(null),B(!1),a(N()),a(z())},6e3))}},[a,j,l,F]),s.useEffect(()=>{if(m&&g==="pending"&&E(!1),m&&g==="rejected"){setTimeout(()=>{E(null),T(!1),a(J())},3e3),setTimeout(()=>{var e,n;(n=(e=l==null?void 0:l.errorMessage)==null?void 0:e.message)==null||n.map(i=>R.error(i,{position:"top-right",theme:"dark",toastId:"multiStudentApprovalError"}))},2e3);return}m&&g==="success"&&(setTimeout(()=>{E(!0)},3e3),setTimeout(()=>{a(N()),q(!v),a(J()),T(!1),E(null)},6e3))},[a,g,l,m,v]),s.useEffect(()=>{if(m&&x==="pending"&&C(!1),m&&x==="rejected"){setTimeout(()=>{C(null),T(!1),a(K())},3e3),setTimeout(()=>{var e,n;(n=(e=l==null?void 0:l.errorMessage)==null?void 0:e.message)==null||n.map(i=>R.error(i,{position:"top-right",theme:"dark",toastId:"multiStudentRejectionError"}))},2e3);return}m&&x==="success"&&(setTimeout(()=>{C(!0)},3e3),setTimeout(()=>{a(N()),q(!v),a(K()),T(!1),C(null)},6e3))},[a,g,l,m,v,x]);const Ce=`All Pending Students / Total = ${r==null?void 0:r.length}`;return t.jsxs(t.Fragment,{children:[t.jsxs(p,{component:"div",id:"adminDashboardHeaderWrap",sx:{position:"sticky",top:0,backgroundColor:"#fff",padding:0},minHeight:"4rem",children:[t.jsxs("h1",{className:"dashAction",children:[f==null?void 0:f.replace(/_/g,"-")," /"," ",t.jsx("span",{children:d==null?void 0:d.replace(/_/g," ")})]}),t.jsx(p,{sx:{display:{xs:"none",sm:"block"}},children:t.jsx(We,{value:c,onChange:ee,placeholder:"Search"})})]}),t.jsxs(p,{className:"allStudentsData",id:"allStudents",padding:{xs:" 1rem .5rem",sm:" 1rem"},children:[t.jsxs(p,{className:"searchDetails",justifyItems:"flex-start",children:[(u==null?void 0:u.length)===0&&c!==""&&t.jsxs("p",{className:"searchInfo",children:[`We couldn't find any matches for "`,c,'"']}),(u==null?void 0:u.length)===0&&c!==""&&t.jsx("p",{style:{paddingLeft:"1.5rem",display:"flex",alignItems:"center",color:"red"},children:"||"}),c&&t.jsxs("p",{className:"searchInfo",children:["Total Pending Students Found = ",u==null?void 0:u.length]}),!c&&t.jsxs("p",{className:"searchInfo",children:["Total Students = ",D==null?void 0:D.length]})]}),t.jsx(p,{children:t.jsxs(A,{container:!0,spacing:3,className:"addNewStudentBtnsWrap",width:"100%",m:"0 auto",children:[Z.map(e=>t.jsx(A,{component:"span",item:!0,xs:2.9,sm:2,onClick:()=>{e.label==="Add New Student +"?L(!0):b(`/sensec/users/${o==null?void 0:o.uniqueId}/admin/${f}/${d}/${e.label.replace(/ /g,"_")}`)},className:(w==null?void 0:w.replace(/_/g," "))===e.label?"studentDashBtn isActive":(e==null?void 0:e.label)==="Add New Student +"?"studentDashAddBtn":"studentDashBtn",children:e.label==="Enrolled"?"All Enrolled Students":e.label},e.label)),t.jsx(He,{open:je,onClose:()=>L(!1),handleNewEnrollment:Ee,redirecting:xe,uncompletedEmploymentTask:Ie,question:"Are you sure you would like to enroll a new student?"})]})}),t.jsx(p,{children:t.jsx(A,{container:!0,spacing:3,width:"100%",m:"0 auto",className:"classLevelStudents",children:ve.map(e=>t.jsx(A,{component:"span",item:!0,xs:2.9,sm:2,mb:".2rem",onClick:()=>b(`/sensec/users/${o==null?void 0:o.uniqueId}/admin/${f}/${d}/${w}/${e.name.replace(/ /g,"_")}`),className:(e==null?void 0:e.name)===(y==null?void 0:y.replace(/_/g," "))?"classLevelStudentsBtn isActive":"classLevelStudentsBtn",children:e.name},e.name))})}),t.jsxs(p,{sx:{display:"flex",gap:1},children:[t.jsx(ye,{approveMultiUsersDataStatus:g,approveMultiUsersDataLoadingComplete:le,multiUsersDataRejectionInProgress:re,setMultiUsersDataApprovalInProgress:T,multiUsersDataApprovalFunction:Ue({students:m,enrollmentApprovedBy:`${o==null?void 0:o.id}`})}),t.jsx($e,{rejectMultiUsersDataStatus:x,rejectMultiUsersDataLoadingComplete:ce,multiUsersDataApprovalInProgress:ne,setMultiUsersDataRejectionInProgress:ie,multiUsersDataApprovalFunction:Be({students:m,enrollmentRejectedBy:`${o==null?void 0:o.id}`})})]}),t.jsx(p,{className:"studentDataTable",children:t.jsx(ke,{title:Ce,columns:we,data:u,customStyles:Fe,pagination:!0,selectableRows:!0,selectableRowsHighlight:!0,highlightOnHover:!0,onSelectedRowsChange:Re,clearSelectedRows:v})})]})]})}export{jt as PendingStudents};
