import{e as oe,a as ae,f as y,h as ie,bF as le,r as a,i as ne,bG as ce,n as $,bH as O,j as t,B as i,T,l as ue,bI as de}from"./index-BrKZIgIs.js";/* empty css               */import{c as d}from"./muiStyling-B8pUMTN3.js";import{R as me}from"./Redirection-B8WeSLSt.js";import{L as pe}from"./LoadingProgress-DyOM2CxY.js";import{F as fe}from"./FetchProgrammeData-DzGaqZbQ.js";import{V as xe,C as he}from"./VpnKey-DiQV_VXv.js";import{G as n}from"./Grid-CMH8KWik.js";import{M as Y}from"./MenuItem-BVBtbdIH.js";import{V as J,a as Q}from"./VisibilityOff-CnPStAEu.js";import{F as ge}from"./FormControlLabel-CxBTaig9.js";import{P as je}from"./PersonAddAlt-BgMfkaeP.js";import{T as Ie}from"./TaskAlt-CZKWz0j9.js";import"./FormLabel-C2cHTcFw.js";import"./index-DcfIKM1A.js";import"./useControlled-BPddiEUe.js";import"./useThemeProps-DJrrucl-.js";import"./getThemeProps-VIUuhX1y.js";import"./index-CXwWd3ii.js";import"./IconButton-D70T8NKk.js";function Be(){var G,F,H,K;const l=oe(),j=ae(),c=y(ie),I=fe(),b=y(le),{signUpStatus:m,successMessage:S,error:g}=y(s=>s==null?void 0:s.authUser),[E,X]=a.useState(!1),[L,Z]=a.useState(!1),[C,P]=a.useState(null),[A,w]=a.useState(!1),[D,U]=a.useState(!1),[q,M]=a.useState(!1),[v,W]=a.useState(!1),[N,z]=a.useState(!1),[p,V]=a.useState(!1),[f,R]=a.useState(!1),[x,_]=a.useState(!1),ee=s=>{U(s.target.checked)},se=s=>{s.preventDefault(),X(r=>!r)},te=s=>{s.preventDefault(),Z(r=>!r)},[e,B]=a.useState({uniqueId:"",programme:"",class:"",userName:"",password:"",confirmPassword:""});console.log(e);const o=c==null?void 0:c.find(s=>{var r;return(s==null?void 0:s.uniqueId)===(e==null?void 0:e.uniqueId)&&((r=s==null?void 0:s.roles)==null?void 0:r.includes("student"))}),k=c==null?void 0:c.find(s=>{var r;return((r=s==null?void 0:s.userSignUpDetails)==null?void 0:r.userName)===(e==null?void 0:e.userName)}),u=s=>{B({...e,[s.target.name]:s.target.value})},re=s=>{var r;if(s.preventDefault(),e!=null&&e.userName&&k){V(!0);return}if(((r=e==null?void 0:e.password)==null?void 0:r.length)<6){R(!0);return}else if((e==null?void 0:e.confirmPassword)!==(e==null?void 0:e.password)){_(!0);return}else l(de(e))};return a.useEffect(()=>{var s,r,h;if(e!=null&&e.uniqueId&&!o){M(!0);return}else M(!1);if((e==null?void 0:e.uniqueId)!==""&&(e==null?void 0:e.programme)!==""&&(e==null?void 0:e.programme)!==((s=o==null?void 0:o.studentSchoolData)==null?void 0:s.program)?W(!0):W(!1),(e==null?void 0:e.uniqueId)!==""&&(e==null?void 0:e.class)!==""&&(e==null?void 0:e.class)!==((r=o==null?void 0:o.studentSchoolData)==null?void 0:r.currentClassLevelSection)){z(!0);return}else z(!1);p&&((e==null?void 0:e.userName)===""||!k)&&V(!1),f&&((e==null?void 0:e.password)===""||((h=e==null?void 0:e.password)==null?void 0:h.length)>=6)&&R(!1),x&&((e==null?void 0:e.confirmPassword)===""||(e==null?void 0:e.confirmPassword)===(e==null?void 0:e.password))&&_(!1)},[e,o,p,k,f,x]),a.useEffect(()=>{l(ne()),l(ce())},[l]),a.useEffect(()=>{var s,r;if(m==="pending"&&P(!1),m==="rejected"){(r=(s=g==null?void 0:g.errorMessage)==null?void 0:s.message)==null||r.map(h=>{$.error(h,{position:"top-center",theme:"light",toastId:h})}),setTimeout(()=>{P(null),l(O())},3e3);return}m==="success"&&($.success(S,{position:"top-center",theme:"dark",toastId:S}),setTimeout(()=>{B({uniqueId:"",programme:"",class:"",userName:"",password:"",confirmPassword:""})},2e3),setTimeout(()=>{P(!0)},3e3),setTimeout(()=>{w(!0)},5e3),setTimeout(()=>{j(`/sensec/users/sign_up/successful/${o==null?void 0:o.uniqueId}`),l(O())},7e3))},[m,g,S,j,l,e,o]),t.jsx(i,{sx:{width:{xs:"95%",sm:"36rem"}},margin:"auto",mt:5,mb:2,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",fontSize:"calc(.7rem + 1vmin)",children:t.jsxs(i,{color:"#696969",sx:{filter:"drop-shadow(0 0 0.3em rgb(255, 255, 255, 0.68))",boxShadow:"0px 1px 9px 1px #454343ad",borderRadius:".4rem",display:{xs:"block",sm:"flex"}},p:1,width:"100%",children:[t.jsx(i,{width:"15rem",sx:{display:{xs:"none",sm:"block"}},children:t.jsxs(i,{className:"left",children:[t.jsx("h1",{children:"Welcome, Cherished Student."}),t.jsx("p",{children:"The Great Sensec is glad to have you here. Kindly fill all required fields to create a new account."})]})}),t.jsx(i,{component:"form",onSubmit:re,ml:{xs:0,sm:1},width:{xs:"100%",sm:"60%"},children:t.jsxs(i,{children:[t.jsxs(i,{mt:1,mb:2,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",children:[t.jsx(xe,{style:{color:"#767474",fontSize:"2rem"}}),t.jsx(T,{variant:"h5",component:"h1",mb:2,sx:{fontSize:"1.7rem"},children:"Students Sign-Up"}),t.jsx(i,{className:"profilePictureWrap",children:t.jsx(i,{className:"profilePictureCont",children:t.jsx("img",{className:"profileImg",src:o?(F=(G=o==null?void 0:o.personalInfo)==null?void 0:G.profilePicture)==null?void 0:F.url:"/assets/noAvatar.png",alt:""})})})]}),t.jsxs(n,{container:!0,spacing:2,children:[t.jsx(n,{item:!0,xs:12,children:t.jsx(d,{fullWidth:!0,label:"Unique ID",name:"uniqueId",value:e==null?void 0:e.uniqueId,onChange:u,required:!0,error:q,helperText:q?"Invalid student-ID!":"",sx:{"& .MuiInputLabel-asterisk":{color:e!=null&&e.uniqueId&&!q?"green":"red"}}})}),t.jsx(n,{item:!0,xs:12,children:t.jsx(d,{select:!0,fullWidth:!0,label:"Select Programme",name:"programme",value:e==null?void 0:e.programme,onChange:u,required:!0,error:v,helperText:v?"Not enrolled into selected programme!":"",sx:{"& .MuiInputLabel-asterisk":{color:e!=null&&e.programme&&!v?"green":"red"}},children:I==null?void 0:I.map(s=>t.jsx(Y,{value:s==null?void 0:s._id,children:s==null?void 0:s.name},s==null?void 0:s._id))})}),t.jsx(n,{item:!0,xs:12,children:t.jsx(d,{select:!0,fullWidth:!0,label:"Class",name:"class",value:e==null?void 0:e.class,onChange:u,required:!0,error:N,helperText:N?"You're not in this class!":"",sx:{"& .MuiInputLabel-asterisk":{color:e!=null&&e.class&&!N?"green":"red"}},children:b==null?void 0:b.map(s=>t.jsx(Y,{value:s==null?void 0:s._id,children:s==null?void 0:s.label},s==null?void 0:s._id))})}),t.jsx(n,{item:!0,xs:12,children:t.jsx(d,{fullWidth:!0,label:"Username",name:"userName",value:e==null?void 0:e.userName,onChange:u,required:!0,error:p,helperText:p?"Username already in use!":"",sx:{"& .MuiInputLabel-asterisk":{color:e!=null&&e.userName&&!p?"green":"red"}}})}),t.jsx(n,{item:!0,xs:12,children:t.jsx(d,{fullWidth:!0,label:"Password",name:"password",value:e==null?void 0:e.password,onChange:u,required:!0,type:E?"text":"password",slotProps:{input:{endAdornment:t.jsx(i,{component:"button",onClick:se,bgcolor:"transparent",children:E?t.jsx(J,{sx:{color:"#696969"}}):t.jsx(Q,{sx:{color:"#696969"}})})}},error:f,helperText:f&&((H=e==null?void 0:e.password)==null?void 0:H.length)>0&&((K=e==null?void 0:e.password)==null?void 0:K.length)<6?"Password must be at least 6 characters long!":"",sx:{"& .MuiInputLabel-asterisk":{color:e!=null&&e.password&&!f?"green":"red"}}})}),t.jsx(n,{item:!0,xs:12,children:t.jsx(d,{fullWidth:!0,label:"Confirm Password",name:"confirmPassword",value:e==null?void 0:e.confirmPassword,onChange:u,required:!0,type:L?"text":"password",slotProps:{input:{endAdornment:t.jsx(i,{component:"button",onClick:te,bgcolor:"transparent",children:L?t.jsx(J,{sx:{color:"#696969"}}):t.jsx(Q,{sx:{color:"#696969"}})})}},error:x,helperText:x?"Confirm password must be same as password!":"",sx:{"& .MuiInputLabel-asterisk":{color:e!=null&&e.confirmPassword&&!x?"green":"red"}}})})]}),t.jsx(i,{children:t.jsx(ge,{control:t.jsx(he,{checked:D,onChange:ee,inputProps:{"aria-label":"controlled"},color:"success"}),label:"Accept terms and conditions",required:!0,sx:{"& .MuiFormControlLabel-asterisk":{color:`${D?"green":"red"}`}}})}),t.jsx(i,{mt:1,children:t.jsxs(T,{children:["Already have an account?"," ",t.jsx(T,{component:"span",onClick:()=>j("/sensec/login"),sx:{cursor:"pointer",color:"green"},children:"Login"})]})}),t.jsxs(ue,{type:"submit",variant:"contained",fullWidth:!0,sx:{backgroundColor:"green",margin:"1rem 0",padding:".5rem",letterSpacing:"1px",textTransform:"capitalize",fontSize:"1em",minHeight:"3.7rem"},children:[C===!1&&t.jsx(pe,{color:"#fff",size:"1.3rem"}),C===null&&t.jsxs(t.Fragment,{children:["Sign Up"," ",t.jsx(je,{className:"signupIcon",sx:{marginLeft:".5rem"}})]}),C===!0&&m==="success"&&!A&&t.jsxs(t.Fragment,{children:["Success"," ",t.jsx(Ie,{className:"signupIcon",sx:{marginLeft:".5rem"}})]}),A&&t.jsx(me,{color:"#fff",size:"1.3rem"})]})]})})]})})}export{Be as StudentsSignUp};
