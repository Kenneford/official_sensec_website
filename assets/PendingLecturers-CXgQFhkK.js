import{f as B,g as pe,a as ue,e as de,u as fe,r as s,n as A,i as M,cE as P,cF as $,j as t,B as p,cG as ge,cH as he,cI as je,cJ as Se}from"./index-BrKZIgIs.js";/* empty css                      */import{X as ye}from"./index.es-DkKOh-Zr.js";import{N as xe}from"./NewEmploymentModal-C_IEBMfs.js";import{c as Me}from"./usersInfoTableStyle-D7rSQ0GJ.js";import{c as ve}from"./LinksFormat-DQzWvp0Y.js";import{c as Te}from"./UsersInfoDataFormat-6-R0KIZy.js";import{a as Ee}from"./FetchLecturers-a6xzIhxY.js";import{S as Ie}from"./SearchFilter-h_gsYJVm.js";import{F as Re}from"./FetchClassLevel-4JV9FIfU.js";import{G as F}from"./Grid-CMH8KWik.js";/* empty css               */import"./Stack-BeB3Qk7_.js";import"./styled-Cwx8AUm3.js";import"./useThemeProps-DJrrucl-.js";import"./getThemeProps-VIUuhX1y.js";import"./react-router-hash-link.esm-CcfNRvgg.js";import"./Edit-YA8l4Fd8.js";import"./TaskAlt-CZKWz0j9.js";import"./SchoolOutlined-D5CmX2zz.js";import"./DateFormatter-B-8qT63H.js";import"./DemotionsModal-CxSKSEQU.js";import"./index-B10MRCJG.js";import"./Close-B2v4nXUt.js";/* empty css                   */import"./Search-svh79qAU.js";function ot(){const o=B(pe),c=Ee();localStorage.getItem("currentEmployeeLink");const w=ue(),O=ve(),l=de();Re();const{approveEmploymentStatus:u,approveMultiEmploymentStatus:d,rejectEmploymentStatus:f,rejectMultiEmploymentStatus:g,successMessage:Ae,error:r}=B(e=>e.employment),{adminCurrentAction:h,adminCurrentLink:v,class_level:De,employees_link:D}=fe(),[_,H]=s.useState(""),[q,G]=s.useState(""),[W,T]=s.useState(null),[n,X]=s.useState(""),[z,E]=s.useState(null),[J,I]=s.useState(null),[Q,C]=s.useState(!1),[Y,N]=s.useState(!1),[K,R]=s.useState(null),a=c==null?void 0:c.filter(e=>e.personalInfo.firstName.toLowerCase().includes(n)||e.personalInfo.firstName.includes(n)||e.personalInfo.lastName.toLowerCase().includes(n)||e.personalInfo.lastName.includes(n)),j=c.find(e=>e._id===_),S=c.find(e=>e._id===q),[V,Z]=s.useState(!1),[ee,L]=s.useState(!1),[te,se]=s.useState(!1),[oe,le]=s.useState(""),[ae,re]=s.useState(!1),ne=Te({setCurrentLecturer:H,loadingComplete:W,setLoadingComplete:T,rejectLoadingComplete:z,setRejectLoadingComplete:E,authAdmin:o,foundLecturer:j,approveEmploymentStatus:u,rejectEmploymentStatus:f,openApproveEmploymentModal:ae,setOpenApproveEmploymentModal:re,setOpenRejectModal:se,openRejectModal:te,setRejectLecturer:G,lecturerToReject:S}),[i,U]=s.useState([]),[y,k]=s.useState(!1),ie=e=>{var m;if(e){const x=(m=e==null?void 0:e.selectedRows)==null?void 0:m.map(b=>({uniqueId:b==null?void 0:b.uniqueId}));U(x)}else U([])},ce=()=>{Z(!0),le("You're being redirected"),setTimeout(()=>{w(`/sensec/users/${o==null?void 0:o.uniqueId}/admin/${h}/new_employment`)},3e3)};s.useEffect(()=>{if(j&&!S){if(u==="pending"&&T(!1),u==="rejected"){setTimeout(()=>{T(null)},3e3),setTimeout(()=>{r.errorMessage.message.map(e=>A.error(e,{position:"top-right",theme:"dark"}))},2e3);return}u==="success"&&(setTimeout(()=>{T(!0)},3e3),setTimeout(()=>{l(M())},6e3))}},[l,u,r,j,S]),s.useEffect(()=>{if(S&&!j){if(f==="pending"&&E(!1),f==="rejected"){setTimeout(()=>{E(null)},3e3),setTimeout(()=>{r.errorMessage.message.map(e=>A.error(e,{position:"top-right",theme:"dark"}))},2e3);return}f==="success"&&(setTimeout(()=>{E(!0)},3e3),setTimeout(()=>{l(M())},6e3))}},[l,f,r,S,j]),s.useEffect(()=>{if(i&&d==="pending"&&I(!1),i&&d==="rejected"){setTimeout(()=>{I(null),C(!1),l(P())},3e3),setTimeout(()=>{var e,m;(m=(e=r==null?void 0:r.errorMessage)==null?void 0:e.message)==null||m.map(x=>A.error(x,{position:"top-right",theme:"dark",toastId:"multiApprovalError"}))},2e3);return}i&&d==="success"&&(setTimeout(()=>{I(!0)},3e3),setTimeout(()=>{l(M()),l(M()),k(!y),l(P()),C(!1),I(null)},6e3))},[l,d,r,i,y]),s.useEffect(()=>{if(i&&g==="pending"&&R(!1),i&&g==="rejected"){setTimeout(()=>{R(null),N(!1),l($())},3e3),setTimeout(()=>{var e,m;(m=(e=r==null?void 0:r.errorMessage)==null?void 0:e.message)==null||m.map(x=>A.error(x,{position:"top-right",theme:"dark",toastId:"multiRejectionError"}))},2e3);return}i&&g==="success"&&(setTimeout(()=>{R(!0)},3e3),setTimeout(()=>{R(null),k(!y),l(M()),l($()),N(!1)},6e3))},[l,g,r,i,y]);const me=`All Pending Lecturers / Total = ${a==null?void 0:a.length}`;return t.jsxs(t.Fragment,{children:[t.jsxs(p,{component:"div",id:"adminDashboardHeaderWrap",sx:{position:"sticky",top:0,backgroundColor:"#fff",padding:0},minHeight:"4rem",children:[t.jsxs("h1",{className:"dashAction",children:[h==null?void 0:h.replace(/_/g,"-")," /"," ",t.jsx("span",{children:v==null?void 0:v.replace(/_/g," ")})]}),t.jsx(p,{sx:{display:{xs:"none",sm:"block"}},children:t.jsx(Ie,{value:n,onChange:X,placeholder:"Search"})})]}),t.jsxs(p,{className:"allAdminsData",id:"allAdmins",padding:{xs:" 1rem .5rem",sm:" 1rem"},children:[t.jsxs(p,{className:"searchDetails",children:[(a==null?void 0:a.length)===0&&n!==""&&t.jsxs("p",{className:"searchInfo",children:[`We couldn't find any matches for "`,n,'"']}),(a==null?void 0:a.length)===0&&n!==""&&t.jsx("p",{style:{paddingLeft:"1.5rem",display:"flex",alignItems:"center",color:"red"},children:"||"}),n&&t.jsxs("p",{className:"searchInfo",children:["Search Result = ",a==null?void 0:a.length]}),!n&&t.jsxs("p",{className:"searchInfo",children:["Total Lecturers = ",c==null?void 0:c.length]})]}),t.jsx(p,{children:t.jsxs(F,{container:!0,spacing:3,className:"addNewAdminBtnsWrap",width:"100%",m:"0 auto",children:[O.map(e=>t.jsx(F,{component:"span",item:!0,xs:2.9,sm:2,onClick:()=>{e.label==="Add New Lecturer +"?L(!0):w(`/sensec/users/${o==null?void 0:o.uniqueId}/admin/${h}/${v}/employees/${e.label.replace(/ /g,"_")}`)},className:(D==null?void 0:D.replace(/_/g," "))===e.label?"adminDashBtn isActive":(e==null?void 0:e.label)==="Add New Lecturer +"?"adminDashAddBtn":"adminDashBtn",children:e.label==="All"?"All Employed Lecturers":e.label},e.label)),t.jsx(xe,{open:ee,onClose:()=>L(!1),handleNewEmployment:ce,redirecting:V,uncompletedEmploymentTask:oe,question:"Are you sure you would like to employ a new Lecturer?"})]})}),t.jsxs(p,{sx:{display:"flex",gap:1,fontSize:"calc(0.7rem + 1vmin)"},children:[t.jsx(ge,{approveMultiUsersDataStatus:d,approveMultiUsersDataLoadingComplete:J,multiUsersDataRejectionInProgress:Y,setMultiUsersDataApprovalInProgress:C,multiUsersDataApprovalFunction:he({employees:i,employmentApprovedBy:`${o==null?void 0:o.id}`})}),t.jsx(je,{rejectMultiUsersDataStatus:g,rejectMultiUsersDataLoadingComplete:K,multiUsersDataApprovalInProgress:Q,setMultiUsersDataRejectionInProgress:N,multiUsersDataApprovalFunction:Se({employees:i,employmentRejectedBy:`${o==null?void 0:o.id}`})})]}),t.jsx(p,{className:"lecturerDataTable",children:t.jsx(ye,{title:me,columns:ne,data:a,customStyles:Me,pagination:!0,selectableRows:!0,fixedHeader:!0,selectableRowsHighlight:!0,highlightOnHover:!0,responsive:!0,onSelectedRowsChange:ie,clearSelectedRows:y})})]})]})}export{ot as PendingLecturers};
