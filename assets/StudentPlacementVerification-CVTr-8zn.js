import{a as w,e as L,u as M,f as G,a0 as J,g as Y,r as m,a9 as z,n as B,a2 as K,j as i,B as V,T as O,l as Q,aa as X}from"./index-BgAz6R-J.js";import{C as Z,c as F}from"./muiStyling-DmAU0UFM.js";/* empty css                                     */import{b as U}from"./FetchAllStudents-CKlFdhWm.js";import{R as D}from"./Redirection-ChYyGRqW.js";import{L as S}from"./LoadingProgress-C8hgd9jP.js";import{G as y}from"./Grid-LFq3_oT1.js";import{T as P}from"./TaskAlt-bfh00-md.js";import"./FormLabel-C_YAtYcn.js";import"./index-DcfIKM1A.js";import"./useControlled-BV50I6TR.js";import"./useThemeProps-JU6LSmm0.js";import"./getThemeProps-IXaZHU6q.js";import"./index-CUAsLGHl.js";import"./IconButton-DXnj9XZJ.js";function he(){const n=w(),u=L(),{adminCurrentAction:a,adminCurrentLink:g}=M(),N=G(J),x=U(),t=G(Y),{verifyStatus:j,error:f,successMessage:H}=G(r=>r.placement),[$,q]=m.useState(!1),[v,A]=m.useState(!1),[d,c]=m.useState(null),[C,h]=m.useState(!1),[E,p]=m.useState(!1),[b,I]=m.useState(!1),[s,_]=m.useState({yearGraduated:"",jhsIndexNo:""}),e=N==null?void 0:N.find(r=>(r==null?void 0:r.jhsIndexNo)===(s==null?void 0:s.jhsIndexNo)),k=x==null?void 0:x.find(r=>{var l;return((l=r==null?void 0:r.studentStatusExtend)==null?void 0:l.enrollmentStatus)==="in progress"}),o=x==null?void 0:x.find(r=>{var l;return(r==null?void 0:r.uniqueId)===(e==null?void 0:e.enrollmentId)&&((l=r==null?void 0:r.studentStatusExtend)==null?void 0:l.enrollmentStatus)==="approved"});console.log(e),console.log(o);const W=r=>{const{name:l,value:T}=r.target;_({...s,[l]:T})},R=r=>{var l;if(r.preventDefault(),c(!1),e!=null&&e.yearGraduated)!o&&(e!=null&&e.enrolled)?(setTimeout(()=>{c(!0),p(!0)},3e3),setTimeout(()=>{h(!0),p(!1)},5e3),setTimeout(()=>{n(a?`/sensec/users/${t==null?void 0:t.uniqueId}/admin/User-Types/Students/${e==null?void 0:e.jhsIndexNo}/new_enrollment`:`/sensec/students/enrollment/online/${e==null?void 0:e.jhsIndexNo}`)},7e3)):e!=null&&e.placementVerified&&(e!=null&&e.enrolled)?(setTimeout(()=>{c(!0),p(!0),I(!0)},3e3),setTimeout(()=>{h(!0),p(!1),I(!1)},5e3),setTimeout(()=>{n(a?`/sensec/users/${t==null?void 0:t.uniqueId}/admin/User-Types/Students/${e==null?void 0:e.enrollmentId}/enrollment/online/success`:`/sensec/students/${e==null?void 0:e.enrollmentId}/enrollment/online/success`)},7e3)):e!=null&&e.placementVerified&&!(e!=null&&e.enrolled)&&k?(setTimeout(()=>{c(!0),p(!0)},3e3),setTimeout(()=>{h(!0),p(!1)},5e3),setTimeout(()=>{n(a?`/sensec/users/${t==null?void 0:t.uniqueId}/admin/User-Types/Students/${e==null?void 0:e.enrollmentId}/new_enrollment/parent/add`:`/sensec/students/enrollment/online/${e==null?void 0:e.enrollmentId}/parent/add`)},7e3)):e!=null&&e.placementVerified&&!(e!=null&&e.enrolled)&&((l=o==null?void 0:o.studentStatusExtend)==null?void 0:l.enrollmentStatus)!=="in progress"&&!(o!=null&&o.parent)?(setTimeout(()=>{c(!0),p(!0)},3e3),setTimeout(()=>{h(!0),p(!1)},5e3),setTimeout(()=>{n(a?`/sensec/users/${t==null?void 0:t.uniqueId}/admin/User-Types/Students/${e==null?void 0:e.jhsIndexNo}/new_enrollment`:`/sensec/students/enrollment/online/${e==null?void 0:e.jhsIndexNo}`)},7e3)):e!=null&&e.placementVerified&&o?(setTimeout(()=>{c(!0),p(!0),I(!0)},3e3),setTimeout(()=>{h(!0),p(!1),I(!1)},5e3),setTimeout(()=>{n(a?`/sensec/users/${t==null?void 0:t.uniqueId}/admin/User-Types/Students/${o==null?void 0:o.uniqueId}/enrollment/online/success`:`/sensec/students/${o==null?void 0:o.uniqueId}/enrollment/online/success`)},7e3)):e&&!(e!=null&&e.placementVerified)&&u(X(s));else return setTimeout(()=>{B.error("Placement data not yet updated!",{position:"top-right",theme:"light",toastId:"placementDataError"}),c(null)},3e3)};return m.useEffect(()=>{if(s!=null&&s.jhsIndexNo&&!e){q(!0);return}else q(!1);if(s!=null&&s.yearGraduated&&e&&(e==null?void 0:e.yearGraduated)!==(s==null?void 0:s.yearGraduated)){A(!0);return}else A(!1)},[s,e]),m.useEffect(()=>{if(j==="pending"&&c(!1),j==="rejected"){setTimeout(()=>{c(null),u(z())},3e3),setTimeout(()=>{var r,l;(l=(r=f==null?void 0:f.errorMessage)==null?void 0:r.message)==null||l.map(T=>B.error(T,{position:"top-right",theme:"light",toastId:T}))},2e3);return}j==="success"&&(setTimeout(()=>{c(!0)},3e3),setTimeout(()=>{h(!0)},6e3),setTimeout(()=>{u(z()),n(a?`/sensec/users/${t==null?void 0:t.uniqueId}/admin/User-Types/Students/${e==null?void 0:e.jhsIndexNo}/new_enrollment`:`/sensec/students/enrollment/online/${e==null?void 0:e.jhsIndexNo}`)},9e3))},[u,n,s,j,f,H,d,e,a,g,t]),m.useEffect(()=>{u(K())},[s,u]),i.jsxs(i.Fragment,{children:[a&&g&&i.jsx(V,{component:"div",id:"adminDashboardHeaderWrap",sx:{position:"sticky",top:0,backgroundColor:"#fff",padding:0},minHeight:"4rem",children:i.jsxs("h1",{className:"dashAction",children:[a==null?void 0:a.replace(/_/g,"-")," /"," ",i.jsx("span",{children:g==null?void 0:g.replace(/_/g," ")})]})}),i.jsxs(Z,{component:"div",id:"placementVerificationWrap",children:[i.jsx("h1",{style:{textAlign:"center",color:"#696969",fontSize:"1.5rem"},children:"Student Placement Verification"}),i.jsx(V,{component:"div",id:"placementFormWrap",sx:{maxWidth:600,mx:"auto",mt:3,p:{xs:1,sm:2},border:"1px solid #ccc",borderRadius:"8px",backgroundColor:"#f9f9f9"},children:i.jsxs(V,{component:"form",autoComplete:"off",onSubmit:R,style:{padding:".5rem "},children:[i.jsx(O,{variant:"h6",component:"h3",mb:3,color:"#696969",fontSize:"1.1rem",lineHeight:"1.2em",letterSpacing:"1px",textAlign:"center",children:"Kindly verify your placement to begin your enrollment."}),i.jsxs(y,{container:!0,spacing:3,children:[i.jsx(y,{item:!0,xs:12,sm:6,children:i.jsx(F,{fullWidth:!0,label:"JHS Index No.",name:"jhsIndexNo",value:s==null?void 0:s.jhsIndexNo,onChange:W,required:!0,error:$,helperText:$?"Invalid student index number!":"",sx:{"& .MuiInputLabel-asterisk":{color:s!=null&&s.jhsIndexNo&&!$?"green":"red"}}})}),i.jsx(y,{item:!0,xs:12,sm:6,children:i.jsx(F,{fullWidth:!0,label:"Year Graduated [ JHS ]",name:"yearGraduated",value:s==null?void 0:s.yearGraduated,onChange:W,required:!0,error:v,helperText:v?"Year graduated not correct!":"",sx:{"& .MuiInputLabel-asterisk":{color:s!=null&&s.yearGraduated&&!v?"green":"red"}}})}),i.jsx(y,{item:!0,xs:12,children:i.jsxs(Q,{variant:"contained",color:"success",type:"submit",fullWidth:!0,sx:{height:"3.5rem",letterSpacing:"1px",textTransform:"capitalize",fontSize:"1em"},children:[d===!1&&i.jsx(S,{color:"#fff",size:"1.5rem"}),d&&E&&!b&&"Placement Already Verified",d&&E&&b&&"Enrolled Already",d&&!E&&!b&&!C&&j==="success"&&i.jsxs(i.Fragment,{children:[i.jsx("span",{children:"Successful"})," ",i.jsx(P,{})]}),d===null&&"Verify Placement",C&&i.jsx(D,{color:"#fff",size:"1.5rem"})]})})]})]})})]})]})}export{he as StudentPlacementVerification};
